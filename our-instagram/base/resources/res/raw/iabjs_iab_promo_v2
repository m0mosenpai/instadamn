(()=>{var t={11:t=>{"use strict";var e=Object.freeze({ANDROID:"ANDROID",IOS:"IOS",WEB:"WEB",UNKNOWN:"UNKNOWN"});t.exports={ANDROID:"ANDROID",IOS:"IOS",WEB:"WEB",UNKNOWN:"UNKNOWN",getDeviceType:function(){return navigator.userAgent?navigator.userAgent.match(/android/i)?e.ANDROID:navigator.userAgent.match(/iPhone/)||navigator.userAgent.match(/iPod/)||navigator.userAgent.match(/iPad/)?e.IOS:navigator.userAgent.match(/Chrome/)||navigator.userAgent.match(/Firefox/)||navigator.userAgent.match(/Safari/)||navigator.userAgent.match(/MSIE|Trident|Edge/)?e.WEB:e.UNKNOWN:e.UNKNOWN}}},444:t=>{t.exports=function(){return"f"+(Math.random()*(1<<30)).toString(16).replace(".","")}},312:t=>{t.exports={registerForPageComplete:function(t){"interactive"===document.readyState||"complete"===document.readyState?t():document.addEventListener("readystatechange",(function(){"interactive"!==document.readyState&&"complete"!==document.readyState||t()}))}}},769:t=>{t.exports=function(t,e){var r=!1;return function(){var n=arguments;r||(t.apply(this,n),r=!0,setTimeout((function(){r=!1}),e))}}}},e={};function r(n){var o=e[n];if(void 0!==o)return o.exports;var i=e[n]={exports:{}};return t[n](i,i.exports,r),i.exports}r.n=t=>{var e=t&&t.__esModule?()=>t.default:()=>t;return r.d(e,{a:e}),e},r.d=(t,e)=>{for(var n in e)r.o(e,n)&&!r.o(t,n)&&Object.defineProperty(t,n,{enumerable:!0,get:e[n]})},r.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),(()=>{"use strict";var t=Object.freeze({INITIALIZE_PROMO_EXTENSION_CALLBACK_HANDLER:"initializePromoExtensionCallbackHandler",GET_PROMO_EXTENSION_NONCE:"getPromoExtensionNonce",REQUEST_PROMO_EXTENSION_PROMO_CODE_AUTOFILL:"requestPromoExtensionPromoCodeAutofill",SEND_PROMO_EXTENSION_PROMO_CODE_AUTOFILL_RESULT:"sendPromoExtensionPromoCodeAutofillResult",REQUEST_PERFORM_AUTOFILL_ACTION:"requestPerformAutofillAction",PERFORM_AUTOFILL_ACTION:"performAutofillAction"}),e=Object.freeze({HIDE:"HIDE",CLICK:"CLICK",WAIT_FOR_VISIBLE:"WAIT_FOR_VISIBLE",FOCUS:"FOCUS",SLEEP:"SLEEP",EXTRACT_OCP:"EXTRACT_OCP",EXTRACT_CHECKOUT:"EXTRACT_CHECKOUT",LISTEN_FOR_EVENT:"LISTEN_FOR_EVENT",VALIDATE_COUPON:"VALIDATE_COUPON",COUPON_EXISTANCE_CHECK:"COUPON_EXISTANCE_CHECK"}),n=Object.freeze({URL:"URL",HTML_ELEMENT:"HTML_ELEMENT"}),o=Object.freeze({SHOP_PAY:"SHOP_PAY"}),i=null,a=r(11),u=r(444),c=r.n(u),l=!1,s=!1,f=!1,h=!1;function p(t){l=t}function d(t){s=t}function v(t){f=t}var y=Object.freeze({INFO:"info"}),m=Object.freeze({ORDER_CONFIRMATION_PAGE_EXTRACT:"ORDER_CONFIRMATION_PAGE_EXTRACT",CHECKOUT_PAGE_EXTRACT:"CHECKOUT_PAGE_EXTRACT",CHECKOUT_PAGE_EXTRACT_ATTEMPT:"CHECKOUT_PAGE_EXTRACT_ATTEMPT",OBSERVE_PASTE_EVENT:"OBSERVE_PASTE_EVENT",PAGE_RELOADED_AFTER_PASTE:"PAGE_RELOADED_AFTER_PASTE",INIT_BRIDGE:"INIT_BRIDGE",RECEIVED_CONFIGS_FROM_IAB:"RECEIVED_CONFIGS_FROM_IAB",COUPON_SIGNAL_APPLY_SUCCESS:"COUPON_SIGNAL_APPLY_SUCCESS",COUPON_SIGNAL_APPLY_FAIL:"COUPON_SIGNAL_APPLY_FAIL",COUPON_SIGNAL_CAPTURE_FAIL:"COUPON_SIGNAL_CAPTURE_FAIL",COUPON_SIGNAL_CAPTURE_SUCCESS:"COUPON_SIGNAL_CAPTURE_SUCCESS",COUPON_VALIDATION_CHECK:"COUPON_VALIDATION_CHECK",COUPON_EXISTANCE_CHECK:"COUPON_EXISTANCE_CHECK",UNKNOWN:"UNKNOWN"}),g=Object.freeze({TIMEOUT:"TIMEOUT",FOUND_ERROR_DESCRIPTION:"FOUND_ERROR_DESCRIPTION",FOUND_PRICE_CHANGE:"FOUND_PRICE_CHANGE",FOUND_SUCCESS_KEYWORDS:"FOUND_SUCCESS_KEYWORDS",FOUND_3RD_PARTY_SELECTOR:"FOUND_3RD_PARTY_SELECTOR",FOUND_FAILURE_KEYWORDS:"FOUND_FAILURE_KEYWORDS",UNABLE_TO_FIND_PRICE_CHANGE_OR_ERROR:"UNABLE_TO_FIND_PRICE_CHANGE_OR_ERROR",NO_SUMMARY_ELEMENT_FOUND:"NO_SUMMARY_ELEMENT_FOUND",PAGE_RELOADED_AFTER_PASTE:"PAGE_RELOADED_AFTER_PASTE",COUPON_APPLIED:"COUPON_APPLIED",INVALID_COUPON_CODE:"INVALID_COUPON_CODE",VALID_COUPON_CODE:"VALID_COUPON_CODE"}),b=Object.freeze({PASTE:"paste"}),E=Object.freeze({HIGH:"high",MEDIUM:"medium",LOW:"low"}),w=Object.freeze({SUCCESS:"success",FAIL:"fail",UNKNOWN:"unknown"}),O=Object.freeze({FAIL:"fail",SUCCESS:"success",INFO:"info"}),_=Object.freeze({HAS_PROMO_CODE_ERROR_ELEMENT:"HAS_PROMO_CODE_ERROR_ELEMENT",REMOVE_PROMO_CODE_ERROR_ELEMENT:"REMOVE_PROMO_CODE_ERROR_ELEMENT",OBSERVE_AUTOFILL_RESULT_TIMEOUT:"OBSERVE_AUTOFILL_RESULT_TIMEOUT",NO_ORDER_SUMMARY_ELEMENT:"NO_ORDER_SUMMARY_ELEMENT",CANNOT_GET_PROMO_CODE:"CANNOT_GET_PROMO_CODE",FILL_IN_PROMO_CODE:"FILL_IN_PROMO_CODE",CANNOT_FILL_IN_PROMO_CODE:"CANNOT_FILL_IN_PROMO_CODE",SHOPIFY_URL_GET_REQUEST:"SHOPIFY_URL_GET_REQUEST",PROMO_CODE_AUTOFILL_ATTEMPT:"PROMO_CODE_AUTOFILL_ATTEMPT",INIT_GENERAL_EXECUTOR:"INIT_GENERAL_EXECUTOR",UNKNOWN:"UNKNOWN"}),x=Object.freeze({GENERAL:"GENERAL",SHOPIFY_STANDARD:"SHOPIFY_STANDARD",SHOPIFY_ENCODED:"SHOPIFY_ENCODED",INSTRUCTION_BASED:"INSTRUCTION_BASED",SHOP_PAY_CHECKOUT:"SHOP_PAY_CHECKOUT"}),S=3e3,P="disclosure_content",L="disclosure_details",N="order-summary",C='[aria-controls="order-summary"]',T='[aria-controls="'+P+'"]',A='[aria-controls="'+L+'"]',j="jquery:";function k(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function I(e){var r=z(t.SEND_PROMO_EXTENSION_PROMO_CODE_AUTOFILL_RESULT);K(r)&&V(r,e)}function R(t){var e,r,n={payload_json:JSON.stringify(t),logging_context:JSON.stringify(null!==(e=null==i||null===(r=i.logging)||void 0===r?void 0:r.context)&&void 0!==e?e:{})};Z("sending to www directly ",n);var o=new FormData;Object.entries(n).forEach((function(t){var e=function(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var r=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=r){var n,o,i,a,u=[],c=!0,l=!1;try{if(i=(r=r.call(t)).next,0===e){if(Object(r)!==r)return;c=!1}else for(;!(c=(n=i.call(r)).done)&&(u.push(n.value),u.length!==e);c=!0);}catch(t){l=!0,o=t}finally{try{if(!c&&null!=r.return&&(a=r.return(),Object(a)!==a))return}finally{if(l)throw o}}return u}}(t,e)||function(t,e){if(t){if("string"==typeof t)return k(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?k(t,e):void 0}}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}(t,2),r=e[0],n=e[1];o.append(r,n)})),fetch("".concat("https://connect.facebook.net/promo_extension/log/"),{mode:"no-cors",method:"POST",body:o}).catch((function(t){return Z("Error in sendPromoExtensionTasksResultV2",t)}))}function F(t){var e=!1;if(Z("getInstructionSignal",t),window.jQuery&&t.includes(j)){var r=t.split(j)[1];e=$(":contains("+r+")").length>0}else t.includes(j)||(e=null!=document.querySelector(t));return e}function D(t){if(null==t)return{is_manual_annotation_covered:!1};var e=F(t.successElementQuery),r=F(t.errorElementQuery);return{is_manual_annotation_covered:!0,apply_result_from_annotation:e?w.SUCCESS:r?w.FAIL:w.UNKNOWN}}function U(t){return U="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},U(t)}function G(){/*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/facebook/regenerator/blob/main/LICENSE */G=function(){return t};var t={},e=Object.prototype,r=e.hasOwnProperty,n=Object.defineProperty||function(t,e,r){t[e]=r.value},o="function"==typeof Symbol?Symbol:{},i=o.iterator||"@@iterator",a=o.asyncIterator||"@@asyncIterator",u=o.toStringTag||"@@toStringTag";function c(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{c({},"")}catch(t){c=function(t,e,r){return t[e]=r}}function l(t,e,r,o){var i=e&&e.prototype instanceof h?e:h,a=Object.create(i.prototype),u=new S(o||[]);return n(a,"_invoke",{value:w(t,r,u)}),a}function s(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}t.wrap=l;var f={};function h(){}function p(){}function d(){}var v={};c(v,i,(function(){return this}));var y=Object.getPrototypeOf,m=y&&y(y(P([])));m&&m!==e&&r.call(m,i)&&(v=m);var g=d.prototype=h.prototype=Object.create(v);function b(t){["next","throw","return"].forEach((function(e){c(t,e,(function(t){return this._invoke(e,t)}))}))}function E(t,e){function o(n,i,a,u){var c=s(t[n],t,i);if("throw"!==c.type){var l=c.arg,f=l.value;return f&&"object"==U(f)&&r.call(f,"__await")?e.resolve(f.__await).then((function(t){o("next",t,a,u)}),(function(t){o("throw",t,a,u)})):e.resolve(f).then((function(t){l.value=t,a(l)}),(function(t){return o("throw",t,a,u)}))}u(c.arg)}var i;n(this,"_invoke",{value:function(t,r){function n(){return new e((function(e,n){o(t,r,e,n)}))}return i=i?i.then(n,n):n()}})}function w(t,e,r){var n="suspendedStart";return function(o,i){if("executing"===n)throw new Error("Generator is already running");if("completed"===n){if("throw"===o)throw i;return{value:void 0,done:!0}}for(r.method=o,r.arg=i;;){var a=r.delegate;if(a){var u=O(a,r);if(u){if(u===f)continue;return u}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if("suspendedStart"===n)throw n="completed",r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);n="executing";var c=s(t,e,r);if("normal"===c.type){if(n=r.done?"completed":"suspendedYield",c.arg===f)continue;return{value:c.arg,done:r.done}}"throw"===c.type&&(n="completed",r.method="throw",r.arg=c.arg)}}}function O(t,e){var r=e.method,n=t.iterator[r];if(void 0===n)return e.delegate=null,"throw"===r&&t.iterator.return&&(e.method="return",e.arg=void 0,O(t,e),"throw"===e.method)||"return"!==r&&(e.method="throw",e.arg=new TypeError("The iterator does not provide a '"+r+"' method")),f;var o=s(n,t.iterator,e.arg);if("throw"===o.type)return e.method="throw",e.arg=o.arg,e.delegate=null,f;var i=o.arg;return i?i.done?(e[t.resultName]=i.value,e.next=t.nextLoc,"return"!==e.method&&(e.method="next",e.arg=void 0),e.delegate=null,f):i:(e.method="throw",e.arg=new TypeError("iterator result is not an object"),e.delegate=null,f)}function _(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function x(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function S(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(_,this),this.reset(!0)}function P(t){if(t){var e=t[i];if(e)return e.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var n=-1,o=function e(){for(;++n<t.length;)if(r.call(t,n))return e.value=t[n],e.done=!1,e;return e.value=void 0,e.done=!0,e};return o.next=o}}return{next:L}}function L(){return{value:void 0,done:!0}}return p.prototype=d,n(g,"constructor",{value:d,configurable:!0}),n(d,"constructor",{value:p,configurable:!0}),p.displayName=c(d,u,"GeneratorFunction"),t.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===p||"GeneratorFunction"===(e.displayName||e.name))},t.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,d):(t.__proto__=d,c(t,u,"GeneratorFunction")),t.prototype=Object.create(g),t},t.awrap=function(t){return{__await:t}},b(E.prototype),c(E.prototype,a,(function(){return this})),t.AsyncIterator=E,t.async=function(e,r,n,o,i){void 0===i&&(i=Promise);var a=new E(l(e,r,n,o),i);return t.isGeneratorFunction(r)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},b(g),c(g,u,"Generator"),c(g,i,(function(){return this})),c(g,"toString",(function(){return"[object Generator]"})),t.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function t(){for(;r.length;){var n=r.pop();if(n in e)return t.value=n,t.done=!1,t}return t.done=!0,t}},t.values=P,S.prototype={constructor:S,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(x),!t)for(var e in this)"t"===e.charAt(0)&&r.call(this,e)&&!isNaN(+e.slice(1))&&(this[e]=void 0)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var e=this;function n(r,n){return a.type="throw",a.arg=t,e.next=r,n&&(e.method="next",e.arg=void 0),!!n}for(var o=this.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],a=i.completion;if("root"===i.tryLoc)return n("end");if(i.tryLoc<=this.prev){var u=r.call(i,"catchLoc"),c=r.call(i,"finallyLoc");if(u&&c){if(this.prev<i.catchLoc)return n(i.catchLoc,!0);if(this.prev<i.finallyLoc)return n(i.finallyLoc)}else if(u){if(this.prev<i.catchLoc)return n(i.catchLoc,!0)}else{if(!c)throw new Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return n(i.finallyLoc)}}}},abrupt:function(t,e){for(var n=this.tryEntries.length-1;n>=0;--n){var o=this.tryEntries[n];if(o.tryLoc<=this.prev&&r.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=t,a.arg=e,i?(this.method="next",this.next=i.finallyLoc,f):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),f},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),x(r),f}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var o=n.arg;x(r)}return o}}throw new Error("illegal catch attempt")},delegateYield:function(t,e,r){return this.delegate={iterator:P(t),resultName:e,nextLoc:r},"next"===this.method&&(this.arg=void 0),f}},t}function M(t,e,r,n,o,i,a){try{var u=t[i](a),c=u.value}catch(t){return void r(t)}u.done?e(c):Promise.resolve(c).then(n,o)}var H={},B=a.getDeviceType(),q=null,Y=!1;function W(t,e,r){if(void 0!==H[e]){var n=null;try{r&&(n=JSON.parse(r))}catch(t){}if(n||(n={}),t)H[e].success(n);else{var o=n.errorMessage;H[e].error(Error(o))}delete H[e]}}function K(t){return!(!q||!q[t])||(Z("Cannot find callName ".concat(t)),!1)}function V(t,e){if(Z("post Message ".concat(t),e),null!=t){var r=JSON.stringify(e);switch(B){case a.IOS:q&&q[t].postMessage(r);break;case a.ANDROID:q&&q[t](r)}}}function X(t,e){return Q.apply(this,arguments)}function Q(){return(Q=function(t){return function(){var e=this,r=arguments;return new Promise((function(n,o){var i=t.apply(e,r);function a(t){M(i,n,o,a,u,"next",t)}function u(t){M(i,n,o,a,u,"throw",t)}a(void 0)}))}}(G().mark((function t(e,r){return G().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",new Promise((function(t,n){q?e in q?(r.callbackID=c()(),Z("gen return params after post message ".concat(e),r),H[r.callbackID]={success:t,error:n},window._PromoExtensionNonce&&(r.nonce=window._PromoExtensionNonce),V(e,r)):n(Error("The API provided by the SDK is not available on this device")):n(Error("JavaScript bridge does not exist"))})));case 1:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function z(t){switch(B){case a.IOS:return t+"ForIABIOS";case a.ANDROID:return t;default:throw Error("Cannot support this message name")}}function J(){return B}window.setTimeout((function(){if(!(q=function(){switch(B){case a.ANDROID:return window._PromoExtensions;case a.IOS:return window.webkit&&window.webkit.messageHandlers}return null}()))throw Error("No extensionAPIBridge");I({result:y.INFO,event:m.INIT_BRIDGE,description:"init the bridge",url:window.location.href}),window._PromoCallbackHandler=W;var e=z(t.INITIALIZE_PROMO_EXTENSION_CALLBACK_HANDLER),r=z(t.GET_PROMO_EXTENSION_NONCE);K(e)&&V(e,{name:"_PromoCallbackHandler"}),K(r)&&X(r,{}).then((function(t){var e=t.nonce,r=t.isDebug,n=t.performAutofillAction,o=t.configsInJSON;window._PromoExtensionNonce=e,Y=r,v(n);var a=JSON.parse(atob(o));Z("Received and set configs in JSON format from IABPromoExtension: ",i=a),I({result:y.INFO,event:m.RECEIVED_CONFIGS_FROM_IAB,description:"received config from IABPromoExtension ".concat(o),url:window.location.href})}),(function(){}))}),0);var Z=function(){for(var t=arguments.length,e=new Array(t),r=0;r<t;r++)e[r]=arguments[r];Y&&console.log("promo-extension",e)};function tt(t){return tt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},tt(t)}function et(){/*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/facebook/regenerator/blob/main/LICENSE */et=function(){return t};var t={},e=Object.prototype,r=e.hasOwnProperty,n=Object.defineProperty||function(t,e,r){t[e]=r.value},o="function"==typeof Symbol?Symbol:{},i=o.iterator||"@@iterator",a=o.asyncIterator||"@@asyncIterator",u=o.toStringTag||"@@toStringTag";function c(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{c({},"")}catch(t){c=function(t,e,r){return t[e]=r}}function l(t,e,r,o){var i=e&&e.prototype instanceof h?e:h,a=Object.create(i.prototype),u=new S(o||[]);return n(a,"_invoke",{value:w(t,r,u)}),a}function s(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}t.wrap=l;var f={};function h(){}function p(){}function d(){}var v={};c(v,i,(function(){return this}));var y=Object.getPrototypeOf,m=y&&y(y(P([])));m&&m!==e&&r.call(m,i)&&(v=m);var g=d.prototype=h.prototype=Object.create(v);function b(t){["next","throw","return"].forEach((function(e){c(t,e,(function(t){return this._invoke(e,t)}))}))}function E(t,e){function o(n,i,a,u){var c=s(t[n],t,i);if("throw"!==c.type){var l=c.arg,f=l.value;return f&&"object"==tt(f)&&r.call(f,"__await")?e.resolve(f.__await).then((function(t){o("next",t,a,u)}),(function(t){o("throw",t,a,u)})):e.resolve(f).then((function(t){l.value=t,a(l)}),(function(t){return o("throw",t,a,u)}))}u(c.arg)}var i;n(this,"_invoke",{value:function(t,r){function n(){return new e((function(e,n){o(t,r,e,n)}))}return i=i?i.then(n,n):n()}})}function w(t,e,r){var n="suspendedStart";return function(o,i){if("executing"===n)throw new Error("Generator is already running");if("completed"===n){if("throw"===o)throw i;return{value:void 0,done:!0}}for(r.method=o,r.arg=i;;){var a=r.delegate;if(a){var u=O(a,r);if(u){if(u===f)continue;return u}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if("suspendedStart"===n)throw n="completed",r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);n="executing";var c=s(t,e,r);if("normal"===c.type){if(n=r.done?"completed":"suspendedYield",c.arg===f)continue;return{value:c.arg,done:r.done}}"throw"===c.type&&(n="completed",r.method="throw",r.arg=c.arg)}}}function O(t,e){var r=e.method,n=t.iterator[r];if(void 0===n)return e.delegate=null,"throw"===r&&t.iterator.return&&(e.method="return",e.arg=void 0,O(t,e),"throw"===e.method)||"return"!==r&&(e.method="throw",e.arg=new TypeError("The iterator does not provide a '"+r+"' method")),f;var o=s(n,t.iterator,e.arg);if("throw"===o.type)return e.method="throw",e.arg=o.arg,e.delegate=null,f;var i=o.arg;return i?i.done?(e[t.resultName]=i.value,e.next=t.nextLoc,"return"!==e.method&&(e.method="next",e.arg=void 0),e.delegate=null,f):i:(e.method="throw",e.arg=new TypeError("iterator result is not an object"),e.delegate=null,f)}function _(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function x(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function S(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(_,this),this.reset(!0)}function P(t){if(t){var e=t[i];if(e)return e.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var n=-1,o=function e(){for(;++n<t.length;)if(r.call(t,n))return e.value=t[n],e.done=!1,e;return e.value=void 0,e.done=!0,e};return o.next=o}}return{next:L}}function L(){return{value:void 0,done:!0}}return p.prototype=d,n(g,"constructor",{value:d,configurable:!0}),n(d,"constructor",{value:p,configurable:!0}),p.displayName=c(d,u,"GeneratorFunction"),t.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===p||"GeneratorFunction"===(e.displayName||e.name))},t.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,d):(t.__proto__=d,c(t,u,"GeneratorFunction")),t.prototype=Object.create(g),t},t.awrap=function(t){return{__await:t}},b(E.prototype),c(E.prototype,a,(function(){return this})),t.AsyncIterator=E,t.async=function(e,r,n,o,i){void 0===i&&(i=Promise);var a=new E(l(e,r,n,o),i);return t.isGeneratorFunction(r)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},b(g),c(g,u,"Generator"),c(g,i,(function(){return this})),c(g,"toString",(function(){return"[object Generator]"})),t.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function t(){for(;r.length;){var n=r.pop();if(n in e)return t.value=n,t.done=!1,t}return t.done=!0,t}},t.values=P,S.prototype={constructor:S,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(x),!t)for(var e in this)"t"===e.charAt(0)&&r.call(this,e)&&!isNaN(+e.slice(1))&&(this[e]=void 0)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var e=this;function n(r,n){return a.type="throw",a.arg=t,e.next=r,n&&(e.method="next",e.arg=void 0),!!n}for(var o=this.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],a=i.completion;if("root"===i.tryLoc)return n("end");if(i.tryLoc<=this.prev){var u=r.call(i,"catchLoc"),c=r.call(i,"finallyLoc");if(u&&c){if(this.prev<i.catchLoc)return n(i.catchLoc,!0);if(this.prev<i.finallyLoc)return n(i.finallyLoc)}else if(u){if(this.prev<i.catchLoc)return n(i.catchLoc,!0)}else{if(!c)throw new Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return n(i.finallyLoc)}}}},abrupt:function(t,e){for(var n=this.tryEntries.length-1;n>=0;--n){var o=this.tryEntries[n];if(o.tryLoc<=this.prev&&r.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=t,a.arg=e,i?(this.method="next",this.next=i.finallyLoc,f):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),f},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),x(r),f}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var o=n.arg;x(r)}return o}}throw new Error("illegal catch attempt")},delegateYield:function(t,e,r){return this.delegate={iterator:P(t),resultName:e,nextLoc:r},"next"===this.method&&(this.arg=void 0),f}},t}function rt(t,e,r,n,o,i,a){try{var u=t[i](a),c=u.value}catch(t){return void r(t)}u.done?e(c):Promise.resolve(c).then(n,o)}function nt(t){return function(){var e=this,r=arguments;return new Promise((function(n,o){var i=t.apply(e,r);function a(t){rt(i,n,o,a,u,"next",t)}function u(t){rt(i,n,o,a,u,"throw",t)}a(void 0)}))}}function ot(t){var e=getComputedStyle(t);return"none"!=e.display&&"visible"==e.visibility}function it(t){return""===t?Promise.reject():new Promise((function(e,r){var n=document.querySelector(t);if(n)return e(n);var o=new MutationObserver((function(r){var n=document.querySelector(t);n&&(e(n),o.disconnect())}));null!=document.body&&o.observe(document.body,{childList:!0,subtree:!0})}))}function at(t){return ut.apply(this,arguments)}function ut(){return(ut=nt(et().mark((function t(e){return et().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(""!==e){t.next=2;break}return t.abrupt("return",Promise.reject());case 2:return t.abrupt("return",new Promise((function(t,r){var n=document.querySelector(e);if(null!=n&&ot(n))return t(n);var o=new MutationObserver((function(r){var n=document.querySelector(e);null!=n&&ot(n)&&(t(n),o.disconnect())}));null!=document.body&&o.observe(document.body,{childList:!0,subtree:!0})})));case 3:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function ct(t){return lt.apply(this,arguments)}function lt(){return(lt=nt(et().mark((function t(e){var r;return et().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r=function t(r){e()?r():setTimeout((function(e){return t(r)}),400)},t.abrupt("return",new Promise(r));case 2:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function st(t){var e=document.documentElement;return null!==e&&-1!==e.innerHTML.indexOf(t.toLowerCase())}function ft(t){return new Promise((function(e){return setTimeout(e,t)}))}var ht=r(769),pt=r.n(ht);function dt(t){return dt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},dt(t)}function vt(){/*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/facebook/regenerator/blob/main/LICENSE */vt=function(){return t};var t={},e=Object.prototype,r=e.hasOwnProperty,n=Object.defineProperty||function(t,e,r){t[e]=r.value},o="function"==typeof Symbol?Symbol:{},i=o.iterator||"@@iterator",a=o.asyncIterator||"@@asyncIterator",u=o.toStringTag||"@@toStringTag";function c(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{c({},"")}catch(t){c=function(t,e,r){return t[e]=r}}function l(t,e,r,o){var i=e&&e.prototype instanceof h?e:h,a=Object.create(i.prototype),u=new S(o||[]);return n(a,"_invoke",{value:w(t,r,u)}),a}function s(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}t.wrap=l;var f={};function h(){}function p(){}function d(){}var v={};c(v,i,(function(){return this}));var y=Object.getPrototypeOf,m=y&&y(y(P([])));m&&m!==e&&r.call(m,i)&&(v=m);var g=d.prototype=h.prototype=Object.create(v);function b(t){["next","throw","return"].forEach((function(e){c(t,e,(function(t){return this._invoke(e,t)}))}))}function E(t,e){function o(n,i,a,u){var c=s(t[n],t,i);if("throw"!==c.type){var l=c.arg,f=l.value;return f&&"object"==dt(f)&&r.call(f,"__await")?e.resolve(f.__await).then((function(t){o("next",t,a,u)}),(function(t){o("throw",t,a,u)})):e.resolve(f).then((function(t){l.value=t,a(l)}),(function(t){return o("throw",t,a,u)}))}u(c.arg)}var i;n(this,"_invoke",{value:function(t,r){function n(){return new e((function(e,n){o(t,r,e,n)}))}return i=i?i.then(n,n):n()}})}function w(t,e,r){var n="suspendedStart";return function(o,i){if("executing"===n)throw new Error("Generator is already running");if("completed"===n){if("throw"===o)throw i;return{value:void 0,done:!0}}for(r.method=o,r.arg=i;;){var a=r.delegate;if(a){var u=O(a,r);if(u){if(u===f)continue;return u}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if("suspendedStart"===n)throw n="completed",r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);n="executing";var c=s(t,e,r);if("normal"===c.type){if(n=r.done?"completed":"suspendedYield",c.arg===f)continue;return{value:c.arg,done:r.done}}"throw"===c.type&&(n="completed",r.method="throw",r.arg=c.arg)}}}function O(t,e){var r=e.method,n=t.iterator[r];if(void 0===n)return e.delegate=null,"throw"===r&&t.iterator.return&&(e.method="return",e.arg=void 0,O(t,e),"throw"===e.method)||"return"!==r&&(e.method="throw",e.arg=new TypeError("The iterator does not provide a '"+r+"' method")),f;var o=s(n,t.iterator,e.arg);if("throw"===o.type)return e.method="throw",e.arg=o.arg,e.delegate=null,f;var i=o.arg;return i?i.done?(e[t.resultName]=i.value,e.next=t.nextLoc,"return"!==e.method&&(e.method="next",e.arg=void 0),e.delegate=null,f):i:(e.method="throw",e.arg=new TypeError("iterator result is not an object"),e.delegate=null,f)}function _(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function x(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function S(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(_,this),this.reset(!0)}function P(t){if(t){var e=t[i];if(e)return e.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var n=-1,o=function e(){for(;++n<t.length;)if(r.call(t,n))return e.value=t[n],e.done=!1,e;return e.value=void 0,e.done=!0,e};return o.next=o}}return{next:L}}function L(){return{value:void 0,done:!0}}return p.prototype=d,n(g,"constructor",{value:d,configurable:!0}),n(d,"constructor",{value:p,configurable:!0}),p.displayName=c(d,u,"GeneratorFunction"),t.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===p||"GeneratorFunction"===(e.displayName||e.name))},t.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,d):(t.__proto__=d,c(t,u,"GeneratorFunction")),t.prototype=Object.create(g),t},t.awrap=function(t){return{__await:t}},b(E.prototype),c(E.prototype,a,(function(){return this})),t.AsyncIterator=E,t.async=function(e,r,n,o,i){void 0===i&&(i=Promise);var a=new E(l(e,r,n,o),i);return t.isGeneratorFunction(r)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},b(g),c(g,u,"Generator"),c(g,i,(function(){return this})),c(g,"toString",(function(){return"[object Generator]"})),t.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function t(){for(;r.length;){var n=r.pop();if(n in e)return t.value=n,t.done=!1,t}return t.done=!0,t}},t.values=P,S.prototype={constructor:S,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(x),!t)for(var e in this)"t"===e.charAt(0)&&r.call(this,e)&&!isNaN(+e.slice(1))&&(this[e]=void 0)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var e=this;function n(r,n){return a.type="throw",a.arg=t,e.next=r,n&&(e.method="next",e.arg=void 0),!!n}for(var o=this.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],a=i.completion;if("root"===i.tryLoc)return n("end");if(i.tryLoc<=this.prev){var u=r.call(i,"catchLoc"),c=r.call(i,"finallyLoc");if(u&&c){if(this.prev<i.catchLoc)return n(i.catchLoc,!0);if(this.prev<i.finallyLoc)return n(i.finallyLoc)}else if(u){if(this.prev<i.catchLoc)return n(i.catchLoc,!0)}else{if(!c)throw new Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return n(i.finallyLoc)}}}},abrupt:function(t,e){for(var n=this.tryEntries.length-1;n>=0;--n){var o=this.tryEntries[n];if(o.tryLoc<=this.prev&&r.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=t,a.arg=e,i?(this.method="next",this.next=i.finallyLoc,f):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),f},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),x(r),f}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var o=n.arg;x(r)}return o}}throw new Error("illegal catch attempt")},delegateYield:function(t,e,r){return this.delegate={iterator:P(t),resultName:e,nextLoc:r},"next"===this.method&&(this.arg=void 0),f}},t}function yt(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}function mt(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?yt(Object(r),!0).forEach((function(e){gt(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):yt(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}function gt(t,e,r){return(e=function(t){var e=function(t,e){if("object"!==dt(t)||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,"string");if("object"!==dt(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"===dt(e)?e:String(e)}(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function bt(t,e,r,n,o,i,a){try{var u=t[i](a),c=u.value}catch(t){return void r(t)}u.done?e(c):Promise.resolve(c).then(n,o)}function Et(t){return function(){var e=this,r=arguments;return new Promise((function(n,o){var i=t.apply(e,r);function a(t){bt(i,n,o,a,u,"next",t)}function u(t){bt(i,n,o,a,u,"throw",t)}a(void 0)}))}}function wt(){return Ot.apply(this,arguments)}function Ot(){return(Ot=Et(vt().mark((function e(){var r,n,o;return vt().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!K(r=z(t.REQUEST_PROMO_EXTENSION_PROMO_CODE_AUTOFILL))){e.next=7;break}return e.next=4,X(r,{});case 4:return n=e.sent,o=n.promoCode,e.abrupt("return",o);case 7:return e.abrupt("return",null);case 8:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function _t(e){var r=z(t.SEND_PROMO_EXTENSION_PROMO_CODE_AUTOFILL_RESULT);K(r)&&V(r,e)}function xt(t,e){return St.apply(this,arguments)}function St(){return(St=Et(vt().mark((function t(e,r){var n,o,i;return vt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(null!=e&&""!==e){t.next=2;break}return t.abrupt("return");case 2:if(st("shopify")){t.next=5;break}return Z(" not a shopify page, skip sending GET request to Shopify "),t.abrupt("return");case 5:document.cookie="discount_code=".concat(e,"; path=/"),n=new AbortController,o=n.signal,i=setTimeout((function(){n.abort(),Z(" GET Request - Time out is triggered ")}),3e3),fetch("/discount/".concat(e),{signal:o}).then((function(t){t.ok&&sessionStorage.setItem("shopifyURLGetRequestSuccess","true");var e="Discount GET request OK (Status: ".concat(t.status," ").concat(t.statusText,")");Z(e),Pt({result:O.INFO,event:_.SHOPIFY_URL_GET_REQUEST,description:e},r)})).catch((function(t){var e="error occurs during the fetch request: ".concat(t);Z(e),Pt({result:O.INFO,event:_.SHOPIFY_URL_GET_REQUEST,description:e},r)})).finally((function(){return clearTimeout(i)}));case 11:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function Pt(t,e){_t(mt(mt({},t),{},{executorType:e,url:window.location.href}))}function Lt(t){return Lt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Lt(t)}function Nt(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}function Ct(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?Nt(Object(r),!0).forEach((function(e){Rt(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):Nt(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}function Tt(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function At(){/*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/facebook/regenerator/blob/main/LICENSE */At=function(){return t};var t={},e=Object.prototype,r=e.hasOwnProperty,n=Object.defineProperty||function(t,e,r){t[e]=r.value},o="function"==typeof Symbol?Symbol:{},i=o.iterator||"@@iterator",a=o.asyncIterator||"@@asyncIterator",u=o.toStringTag||"@@toStringTag";function c(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{c({},"")}catch(t){c=function(t,e,r){return t[e]=r}}function l(t,e,r,o){var i=e&&e.prototype instanceof h?e:h,a=Object.create(i.prototype),u=new S(o||[]);return n(a,"_invoke",{value:w(t,r,u)}),a}function s(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}t.wrap=l;var f={};function h(){}function p(){}function d(){}var v={};c(v,i,(function(){return this}));var y=Object.getPrototypeOf,m=y&&y(y(P([])));m&&m!==e&&r.call(m,i)&&(v=m);var g=d.prototype=h.prototype=Object.create(v);function b(t){["next","throw","return"].forEach((function(e){c(t,e,(function(t){return this._invoke(e,t)}))}))}function E(t,e){function o(n,i,a,u){var c=s(t[n],t,i);if("throw"!==c.type){var l=c.arg,f=l.value;return f&&"object"==Lt(f)&&r.call(f,"__await")?e.resolve(f.__await).then((function(t){o("next",t,a,u)}),(function(t){o("throw",t,a,u)})):e.resolve(f).then((function(t){l.value=t,a(l)}),(function(t){return o("throw",t,a,u)}))}u(c.arg)}var i;n(this,"_invoke",{value:function(t,r){function n(){return new e((function(e,n){o(t,r,e,n)}))}return i=i?i.then(n,n):n()}})}function w(t,e,r){var n="suspendedStart";return function(o,i){if("executing"===n)throw new Error("Generator is already running");if("completed"===n){if("throw"===o)throw i;return{value:void 0,done:!0}}for(r.method=o,r.arg=i;;){var a=r.delegate;if(a){var u=O(a,r);if(u){if(u===f)continue;return u}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if("suspendedStart"===n)throw n="completed",r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);n="executing";var c=s(t,e,r);if("normal"===c.type){if(n=r.done?"completed":"suspendedYield",c.arg===f)continue;return{value:c.arg,done:r.done}}"throw"===c.type&&(n="completed",r.method="throw",r.arg=c.arg)}}}function O(t,e){var r=e.method,n=t.iterator[r];if(void 0===n)return e.delegate=null,"throw"===r&&t.iterator.return&&(e.method="return",e.arg=void 0,O(t,e),"throw"===e.method)||"return"!==r&&(e.method="throw",e.arg=new TypeError("The iterator does not provide a '"+r+"' method")),f;var o=s(n,t.iterator,e.arg);if("throw"===o.type)return e.method="throw",e.arg=o.arg,e.delegate=null,f;var i=o.arg;return i?i.done?(e[t.resultName]=i.value,e.next=t.nextLoc,"return"!==e.method&&(e.method="next",e.arg=void 0),e.delegate=null,f):i:(e.method="throw",e.arg=new TypeError("iterator result is not an object"),e.delegate=null,f)}function _(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function x(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function S(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(_,this),this.reset(!0)}function P(t){if(t){var e=t[i];if(e)return e.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var n=-1,o=function e(){for(;++n<t.length;)if(r.call(t,n))return e.value=t[n],e.done=!1,e;return e.value=void 0,e.done=!0,e};return o.next=o}}return{next:L}}function L(){return{value:void 0,done:!0}}return p.prototype=d,n(g,"constructor",{value:d,configurable:!0}),n(d,"constructor",{value:p,configurable:!0}),p.displayName=c(d,u,"GeneratorFunction"),t.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===p||"GeneratorFunction"===(e.displayName||e.name))},t.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,d):(t.__proto__=d,c(t,u,"GeneratorFunction")),t.prototype=Object.create(g),t},t.awrap=function(t){return{__await:t}},b(E.prototype),c(E.prototype,a,(function(){return this})),t.AsyncIterator=E,t.async=function(e,r,n,o,i){void 0===i&&(i=Promise);var a=new E(l(e,r,n,o),i);return t.isGeneratorFunction(r)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},b(g),c(g,u,"Generator"),c(g,i,(function(){return this})),c(g,"toString",(function(){return"[object Generator]"})),t.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function t(){for(;r.length;){var n=r.pop();if(n in e)return t.value=n,t.done=!1,t}return t.done=!0,t}},t.values=P,S.prototype={constructor:S,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(x),!t)for(var e in this)"t"===e.charAt(0)&&r.call(this,e)&&!isNaN(+e.slice(1))&&(this[e]=void 0)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var e=this;function n(r,n){return a.type="throw",a.arg=t,e.next=r,n&&(e.method="next",e.arg=void 0),!!n}for(var o=this.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],a=i.completion;if("root"===i.tryLoc)return n("end");if(i.tryLoc<=this.prev){var u=r.call(i,"catchLoc"),c=r.call(i,"finallyLoc");if(u&&c){if(this.prev<i.catchLoc)return n(i.catchLoc,!0);if(this.prev<i.finallyLoc)return n(i.finallyLoc)}else if(u){if(this.prev<i.catchLoc)return n(i.catchLoc,!0)}else{if(!c)throw new Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return n(i.finallyLoc)}}}},abrupt:function(t,e){for(var n=this.tryEntries.length-1;n>=0;--n){var o=this.tryEntries[n];if(o.tryLoc<=this.prev&&r.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=t,a.arg=e,i?(this.method="next",this.next=i.finallyLoc,f):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),f},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),x(r),f}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var o=n.arg;x(r)}return o}}throw new Error("illegal catch attempt")},delegateYield:function(t,e,r){return this.delegate={iterator:P(t),resultName:e,nextLoc:r},"next"===this.method&&(this.arg=void 0),f}},t}function jt(t,e,r,n,o,i,a){try{var u=t[i](a),c=u.value}catch(t){return void r(t)}u.done?e(c):Promise.resolve(c).then(n,o)}function kt(t){return function(){var e=this,r=arguments;return new Promise((function(n,o){var i=t.apply(e,r);function a(t){jt(i,n,o,a,u,"next",t)}function u(t){jt(i,n,o,a,u,"throw",t)}a(void 0)}))}}function It(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,Ft(n.key),n)}}function Rt(t,e,r){return(e=Ft(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Ft(t){var e=function(t,e){if("object"!==Lt(t)||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,"string");if("object"!==Lt(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"===Lt(e)?e:String(e)}var Dt=function(){function e(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,e),Rt(this,"promoCode",""),this.genMaybeSendPromoCodeToShopify();var t=window.location.href;t.includes("/checkouts/")&&((sessionStorage.getItem("prevURL")||"").includes("/checkouts/")?d(!0):d(!1)),Z("setting prevURL to sessionStorage ",t),sessionStorage.setItem("prevURL",t)}var r,o,a,u,y,m,g,b;return r=e,o=[{key:"genMaybeSendPromoCodeToShopify",value:(b=kt(At().mark((function t(){var e,r,o;return At().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(null==(r=null==i||null===(e=i.autofill)||void 0===e?void 0:e.shopifyBasedAutoApply)||r.method!==n.URL){t.next=12;break}if(h=!0,this.promoCode=r.promoCodes[0].toUpperCase(),null!=this.promoCode&&""!==this.promoCode){t.next=10;break}return t.next=7,wt();case 7:o=t.sent,Z("no promo-code in the config, use adhoc instead ",o),null!=o&&""!==o&&"META"!==o&&(this.promoCode=o);case 10:"false"===(sessionStorage.getItem("shopifyURLGetRequestSuccess")||"false")&&xt(this.promoCode,this.getExecutorName());case 12:case"end":return t.stop()}}),t,this)}))),function(){return b.apply(this,arguments)})},{key:"getExecutorName",value:function(){return x.GENERAL}},{key:"genExecuteActionsBeforeAutofill",value:(g=kt(At().mark((function t(){return At().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:case"end":return t.stop()}}),t)}))),function(){return g.apply(this,arguments)})},{key:"genExecuteActionsAfterAutofill",value:(m=kt(At().mark((function t(){return At().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:case"end":return t.stop()}}),t)}))),function(){return m.apply(this,arguments)})},{key:"sendPromoExtensionPromoCodeAutofillSuccessCouponMetadata",value:function(t){}},{key:"getFirstPromoCodeInput",value:function(){return function(t){return function(t){if(Array.isArray(t))return Tt(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(t){if("string"==typeof t)return Tt(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?Tt(t,e):void 0}}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}(document.getElementsByTagName("input")).find((function(t){var e=t.type,r=t.name,n=t.placeholder,o=t.id;return t.value,"text"===e&&ot(t)&&[r,n,o].some((function(t){return t.match(/[Rr]eduction([ -_][Cc]ode)?|[dD]iscount[ -_][Cc]ode|[Pp]romo[ -_][Cc]ode|[Cc]oupon/i)}))}))}},{key:"applyPromoCode",value:function(t){var e,r;null===(e=t.form)||void 0===e||null===(r=e.querySelector("button"))||void 0===r||r.click()}},{key:"fillInPromoCode",value:function(t,e){var r;t.focus(),t.click();var n=null===(r=Object.getOwnPropertyDescriptor(window.HTMLInputElement.prototype,"value"))||void 0===r?void 0:r.set;null==n||n.call(t,e),t.value=e,t.dispatchEvent(new Event("input",{bubbles:!0})),t.dispatchEvent(new Event("change",{bubbles:!0}))}},{key:"genObserveApplyPromoCodeResult",value:(y=kt(At().mark((function t(e){return At().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:case 1:case"end":return t.stop()}}),t)}))),function(t){return y.apply(this,arguments)})},{key:"genHandlePromoCodeAutoFillRequest",value:(u=kt(At().mark((function t(e){var r,n,o;return At().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(Z(e,"Promo code autofill starts"),f&&!l&&!s){t.next=4;break}return Z(e,"Promo code autofill ends",{allowPerformAutofillAction:f,isPromoCodeAutofilling:l,promoCodeAutofillExecuted:s}),t.abrupt("return");case 4:return p(!0),h&&(Z(e,"SKIP AUTO-APPLY- promo code "+this.promoCode),d(!0),""!==this.promoCode&&st("shopify")&&this.genObserveApplyPromoCodeResult(this.promoCode)),t.next=8,this.genExecuteActionsBeforeAutofill();case 8:if(r=null,n=10,h){t.next=42;break}case 11:if(!(n-- >0)||null!=r&&""!==r.value){t.next=28;break}return t.next=14,ft(500);case 14:if(null==(r=this.getFirstPromoCodeInput())||""!==r.value){t.next=26;break}return t.next=18,wt();case 18:if(null!=(o=t.sent)){t.next=25;break}return d(!0),this.sendPromoExtensionPromoCodeAutofillResultForExecutor({result:O.FAIL,event:_.CANNOT_GET_PROMO_CODE,description:"Cannot not get promoCode"}),Z(e,"Promo code autofill ends"),p(!1),t.abrupt("return");case 25:this.fillInPromoCode(r,o);case 26:t.next=11;break;case 28:if(null==r){t.next=42;break}if(d(!0),""!==r.value){t.next=34;break}this.sendPromoExtensionPromoCodeAutofillResultForExecutor({result:O.FAIL,event:_.CANNOT_FILL_IN_PROMO_CODE,description:"Cannot fill in the coupon code"}),t.next=42;break;case 34:return this.sendPromoExtensionPromoCodeAutofillResultForExecutor({result:O.INFO,event:_.FILL_IN_PROMO_CODE,description:"Fill in the coupon code"}),t.next=37,ft(500);case 37:return this.applyPromoCode(r),t.next=40,this.genObserveApplyPromoCodeResult(r.value);case 40:return t.next=42,this.genExecuteActionsAfterAutofill();case 42:return Z(e,"Promo code autofill ends",{input:r}),p(!1),t.abrupt("return");case 45:case"end":return t.stop()}}),t,this)}))),function(t){return u.apply(this,arguments)})},{key:"genExecute",value:(a=kt(At().mark((function e(){var r,n=this;return At().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=this.getExecutorName(),"complete"!==document.readyState){e.next=4;break}return e.next=4,this.genHandlePromoCodeAutoFillRequest("loaded-promo-autofill-".concat(r,"-")+c()());case 4:window.addEventListener("load",function(){var t=kt(At().mark((function t(e){return At().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:pt()(kt(At().mark((function t(){return At().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,n.genHandlePromoCodeAutoFillRequest("load-promo-autofill-".concat(r,"-")+c()());case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t)}))),200)();case 1:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}()),window.addEventListener("message",function(){var e=kt(At().mark((function e(o){var i;return At().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(o.origin===window.location.origin){e.next=2;break}return e.abrupt("return");case 2:if("string"==typeof(i=o.data)){e.next=5;break}return e.abrupt("return");case 5:i===t.PERFORM_AUTOFILL_ACTION&&(v(!0),n.genMaybeSendPromoCodeToShopify(),pt()(kt(At().mark((function t(){return At().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,n.genHandlePromoCodeAutoFillRequest("message-promo-autofill-".concat(r,"-")+c()());case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t)}))),200)());case 6:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}());case 6:case"end":return e.stop()}}),e,this)}))),function(){return a.apply(this,arguments)})},{key:"sendPromoExtensionPromoCodeAutofillResultForExecutor",value:function(t){_t(Ct(Ct({},t),{},{executorType:this.getExecutorName(),url:window.location.href}))}}],o&&It(r.prototype,o),Object.defineProperty(r,"prototype",{writable:!1}),e}();function Ut(t){return Ut="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ut(t)}function Gt(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function Mt(){/*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/facebook/regenerator/blob/main/LICENSE */Mt=function(){return t};var t={},e=Object.prototype,r=e.hasOwnProperty,n=Object.defineProperty||function(t,e,r){t[e]=r.value},o="function"==typeof Symbol?Symbol:{},i=o.iterator||"@@iterator",a=o.asyncIterator||"@@asyncIterator",u=o.toStringTag||"@@toStringTag";function c(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{c({},"")}catch(t){c=function(t,e,r){return t[e]=r}}function l(t,e,r,o){var i=e&&e.prototype instanceof h?e:h,a=Object.create(i.prototype),u=new S(o||[]);return n(a,"_invoke",{value:w(t,r,u)}),a}function s(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}t.wrap=l;var f={};function h(){}function p(){}function d(){}var v={};c(v,i,(function(){return this}));var y=Object.getPrototypeOf,m=y&&y(y(P([])));m&&m!==e&&r.call(m,i)&&(v=m);var g=d.prototype=h.prototype=Object.create(v);function b(t){["next","throw","return"].forEach((function(e){c(t,e,(function(t){return this._invoke(e,t)}))}))}function E(t,e){function o(n,i,a,u){var c=s(t[n],t,i);if("throw"!==c.type){var l=c.arg,f=l.value;return f&&"object"==Ut(f)&&r.call(f,"__await")?e.resolve(f.__await).then((function(t){o("next",t,a,u)}),(function(t){o("throw",t,a,u)})):e.resolve(f).then((function(t){l.value=t,a(l)}),(function(t){return o("throw",t,a,u)}))}u(c.arg)}var i;n(this,"_invoke",{value:function(t,r){function n(){return new e((function(e,n){o(t,r,e,n)}))}return i=i?i.then(n,n):n()}})}function w(t,e,r){var n="suspendedStart";return function(o,i){if("executing"===n)throw new Error("Generator is already running");if("completed"===n){if("throw"===o)throw i;return{value:void 0,done:!0}}for(r.method=o,r.arg=i;;){var a=r.delegate;if(a){var u=O(a,r);if(u){if(u===f)continue;return u}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if("suspendedStart"===n)throw n="completed",r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);n="executing";var c=s(t,e,r);if("normal"===c.type){if(n=r.done?"completed":"suspendedYield",c.arg===f)continue;return{value:c.arg,done:r.done}}"throw"===c.type&&(n="completed",r.method="throw",r.arg=c.arg)}}}function O(t,e){var r=e.method,n=t.iterator[r];if(void 0===n)return e.delegate=null,"throw"===r&&t.iterator.return&&(e.method="return",e.arg=void 0,O(t,e),"throw"===e.method)||"return"!==r&&(e.method="throw",e.arg=new TypeError("The iterator does not provide a '"+r+"' method")),f;var o=s(n,t.iterator,e.arg);if("throw"===o.type)return e.method="throw",e.arg=o.arg,e.delegate=null,f;var i=o.arg;return i?i.done?(e[t.resultName]=i.value,e.next=t.nextLoc,"return"!==e.method&&(e.method="next",e.arg=void 0),e.delegate=null,f):i:(e.method="throw",e.arg=new TypeError("iterator result is not an object"),e.delegate=null,f)}function _(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function x(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function S(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(_,this),this.reset(!0)}function P(t){if(t){var e=t[i];if(e)return e.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var n=-1,o=function e(){for(;++n<t.length;)if(r.call(t,n))return e.value=t[n],e.done=!1,e;return e.value=void 0,e.done=!0,e};return o.next=o}}return{next:L}}function L(){return{value:void 0,done:!0}}return p.prototype=d,n(g,"constructor",{value:d,configurable:!0}),n(d,"constructor",{value:p,configurable:!0}),p.displayName=c(d,u,"GeneratorFunction"),t.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===p||"GeneratorFunction"===(e.displayName||e.name))},t.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,d):(t.__proto__=d,c(t,u,"GeneratorFunction")),t.prototype=Object.create(g),t},t.awrap=function(t){return{__await:t}},b(E.prototype),c(E.prototype,a,(function(){return this})),t.AsyncIterator=E,t.async=function(e,r,n,o,i){void 0===i&&(i=Promise);var a=new E(l(e,r,n,o),i);return t.isGeneratorFunction(r)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},b(g),c(g,u,"Generator"),c(g,i,(function(){return this})),c(g,"toString",(function(){return"[object Generator]"})),t.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function t(){for(;r.length;){var n=r.pop();if(n in e)return t.value=n,t.done=!1,t}return t.done=!0,t}},t.values=P,S.prototype={constructor:S,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(x),!t)for(var e in this)"t"===e.charAt(0)&&r.call(this,e)&&!isNaN(+e.slice(1))&&(this[e]=void 0)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var e=this;function n(r,n){return a.type="throw",a.arg=t,e.next=r,n&&(e.method="next",e.arg=void 0),!!n}for(var o=this.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],a=i.completion;if("root"===i.tryLoc)return n("end");if(i.tryLoc<=this.prev){var u=r.call(i,"catchLoc"),c=r.call(i,"finallyLoc");if(u&&c){if(this.prev<i.catchLoc)return n(i.catchLoc,!0);if(this.prev<i.finallyLoc)return n(i.finallyLoc)}else if(u){if(this.prev<i.catchLoc)return n(i.catchLoc,!0)}else{if(!c)throw new Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return n(i.finallyLoc)}}}},abrupt:function(t,e){for(var n=this.tryEntries.length-1;n>=0;--n){var o=this.tryEntries[n];if(o.tryLoc<=this.prev&&r.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=t,a.arg=e,i?(this.method="next",this.next=i.finallyLoc,f):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),f},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),x(r),f}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var o=n.arg;x(r)}return o}}throw new Error("illegal catch attempt")},delegateYield:function(t,e,r){return this.delegate={iterator:P(t),resultName:e,nextLoc:r},"next"===this.method&&(this.arg=void 0),f}},t}function Ht(t,e,r,n,o,i,a){try{var u=t[i](a),c=u.value}catch(t){return void r(t)}u.done?e(c):Promise.resolve(c).then(n,o)}function Bt(t){return function(){var e=this,r=arguments;return new Promise((function(n,o){var i=t.apply(e,r);function a(t){Ht(i,n,o,a,u,"next",t)}function u(t){Ht(i,n,o,a,u,"throw",t)}a(void 0)}))}}function qt(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(void 0,o=function(t,e){if("object"!==Ut(t)||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,"string");if("object"!==Ut(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(n.key),"symbol"===Ut(o)?o:String(o)),n)}var o}function Yt(){return Yt="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,r){var n=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=Vt(t)););return t}(t,e);if(n){var o=Object.getOwnPropertyDescriptor(n,e);return o.get?o.get.call(arguments.length<3?t:r):o.value}},Yt.apply(this,arguments)}function Wt(t,e){return Wt=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},Wt(t,e)}function Kt(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var r,n=Vt(t);if(e){var o=Vt(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return function(t,e){if(e&&("object"===Ut(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,r)}}function Vt(t){return Vt=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},Vt(t)}var Xt=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Wt(t,e)}(l,t);var e,r,n,o,i,a,u=Kt(l);function l(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,l),u.apply(this,arguments)}return e=l,r=[{key:"getExecutorName",value:function(){return x.SHOPIFY_STANDARD}},{key:"genExecuteActionsBeforeAutofill",value:(a=Bt(Mt().mark((function t(){var e,r;return Mt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!h){t.next=4;break}if(null==(e=document.getElementById("order-summary"))||this.isPromoCodeSuccess(e,this.promoCode,!1)){t.next=4;break}return t.abrupt("return");case 4:"false"===(null==(r=document.querySelector(C))?void 0:r.getAttribute("aria-expanded"))&&(null==r||r.click());case 6:case"end":return t.stop()}}),t,this)}))),function(){return a.apply(this,arguments)})},{key:"genExecuteActionsAfterAutofill",value:(i=Bt(Mt().mark((function t(){return Mt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:case"end":return t.stop()}}),t)}))),function(){return i.apply(this,arguments)})},{key:"getFirstPromoCodeInput",value:function(){var t=document.getElementById("checkout_reduction_code");return t instanceof HTMLInputElement&&ot(t)?t:null}},{key:"genObserveApplyPromoCodeResult",value:(o=Bt(Mt().mark((function t(e){var r,n=this;return Mt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(this.sendPromoExtensionPromoCodeAutofillResultForExecutor({result:O.INFO,event:_.PROMO_CODE_AUTOFILL_ATTEMPT,description:"Promo code autofill attempt"}),null!=(r=document.getElementById(N))){t.next=5;break}return this.sendPromoExtensionPromoCodeAutofillResultForExecutor({result:O.FAIL,event:_.NO_ORDER_SUMMARY_ELEMENT,description:"Cannot find order summary element"}),t.abrupt("return");case 5:if(!this.isPromoCodeSuccess(r,e)&&!this.isErrorElementExist(r,e)){t.next=7;break}return t.abrupt("return");case 7:return t.abrupt("return",new Promise((function(t,o){Z("Starts to observe apply promo code");var i=!1,a=new MutationObserver((function(o){o.forEach((function(o){i||(n.isPromoCodeSuccess(r,e)||n.isErrorElementExist(r,e))&&(i=!0,a.disconnect(),t())}))}));window.setTimeout((function(){i||(n.isPromoCodeSuccess(r,e)||n.sendPromoExtensionPromoCodeAutofillResultForExecutor({result:O.FAIL,event:_.OBSERVE_AUTOFILL_RESULT_TIMEOUT,description:"Timeout"}),a.disconnect(),t())}),S),a.observe(r,{childList:!0,subtree:!0})})));case 8:case"end":return t.stop()}}),t,this)}))),function(t){return o.apply(this,arguments)})},{key:"genExecute",value:(n=Bt(Mt().mark((function t(){var e,r=this;return Mt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:Yt(Vt(l.prototype),"genExecute",this).call(this),e=this.getExecutorName(),it(C).then(Bt(Mt().mark((function t(){return Mt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,ft(200);case 2:return t.next=4,r.genHandlePromoCodeAutoFillRequest("element-exists-promo-autofill-".concat(e,"-")+c()());case 4:case"end":return t.stop()}}),t)})))).catch((function(t){Z("no order summary element")}));case 3:case"end":return t.stop()}}),t,this)}))),function(){return n.apply(this,arguments)})},{key:"isPromoCodeSuccess",value:function(t,e){var r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];return!!function(t){return function(t){if(Array.isArray(t))return Gt(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(t){if("string"==typeof t)return Gt(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?Gt(t,e):void 0}}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}(t.getElementsByClassName("reduction-code__text")).some((function(t){return t.textContent.includes(e)}))&&(r&&this.sendPromoExtensionPromoCodeAutofillResultForExecutor({result:O.SUCCESS}),!0)}},{key:"isErrorElementExist",value:function(t,e){var r,n=null!==(r=t.getElementsByClassName("notice__content").item(0))&&void 0!==r?r:document.getElementById("error-for-reduction_code");if(null!=n){var o=n.textContent;if(null!==o&&""!==o||(o="unknown"),h){this.sendPromoExtensionPromoCodeAutofillResultForExecutor({result:O.FAIL,event:_.REMOVE_PROMO_CODE_ERROR_ELEMENT,description:o});var i=function(t){for(var e=t;e;){if("FORM"===e.nodeName)return e;e=e.parentNode}return null}(n);null==i||i.remove()}else this.sendPromoExtensionPromoCodeAutofillResultForExecutor({result:O.FAIL,event:_.HAS_PROMO_CODE_ERROR_ELEMENT,description:o});return!0}return!1}}],r&&qt(e.prototype,r),Object.defineProperty(e,"prototype",{writable:!1}),l}(Dt);function Qt(t){return Qt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Qt(t)}function zt(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function Jt(){/*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/facebook/regenerator/blob/main/LICENSE */Jt=function(){return t};var t={},e=Object.prototype,r=e.hasOwnProperty,n=Object.defineProperty||function(t,e,r){t[e]=r.value},o="function"==typeof Symbol?Symbol:{},i=o.iterator||"@@iterator",a=o.asyncIterator||"@@asyncIterator",u=o.toStringTag||"@@toStringTag";function c(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{c({},"")}catch(t){c=function(t,e,r){return t[e]=r}}function l(t,e,r,o){var i=e&&e.prototype instanceof h?e:h,a=Object.create(i.prototype),u=new S(o||[]);return n(a,"_invoke",{value:w(t,r,u)}),a}function s(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}t.wrap=l;var f={};function h(){}function p(){}function d(){}var v={};c(v,i,(function(){return this}));var y=Object.getPrototypeOf,m=y&&y(y(P([])));m&&m!==e&&r.call(m,i)&&(v=m);var g=d.prototype=h.prototype=Object.create(v);function b(t){["next","throw","return"].forEach((function(e){c(t,e,(function(t){return this._invoke(e,t)}))}))}function E(t,e){function o(n,i,a,u){var c=s(t[n],t,i);if("throw"!==c.type){var l=c.arg,f=l.value;return f&&"object"==Qt(f)&&r.call(f,"__await")?e.resolve(f.__await).then((function(t){o("next",t,a,u)}),(function(t){o("throw",t,a,u)})):e.resolve(f).then((function(t){l.value=t,a(l)}),(function(t){return o("throw",t,a,u)}))}u(c.arg)}var i;n(this,"_invoke",{value:function(t,r){function n(){return new e((function(e,n){o(t,r,e,n)}))}return i=i?i.then(n,n):n()}})}function w(t,e,r){var n="suspendedStart";return function(o,i){if("executing"===n)throw new Error("Generator is already running");if("completed"===n){if("throw"===o)throw i;return{value:void 0,done:!0}}for(r.method=o,r.arg=i;;){var a=r.delegate;if(a){var u=O(a,r);if(u){if(u===f)continue;return u}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if("suspendedStart"===n)throw n="completed",r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);n="executing";var c=s(t,e,r);if("normal"===c.type){if(n=r.done?"completed":"suspendedYield",c.arg===f)continue;return{value:c.arg,done:r.done}}"throw"===c.type&&(n="completed",r.method="throw",r.arg=c.arg)}}}function O(t,e){var r=e.method,n=t.iterator[r];if(void 0===n)return e.delegate=null,"throw"===r&&t.iterator.return&&(e.method="return",e.arg=void 0,O(t,e),"throw"===e.method)||"return"!==r&&(e.method="throw",e.arg=new TypeError("The iterator does not provide a '"+r+"' method")),f;var o=s(n,t.iterator,e.arg);if("throw"===o.type)return e.method="throw",e.arg=o.arg,e.delegate=null,f;var i=o.arg;return i?i.done?(e[t.resultName]=i.value,e.next=t.nextLoc,"return"!==e.method&&(e.method="next",e.arg=void 0),e.delegate=null,f):i:(e.method="throw",e.arg=new TypeError("iterator result is not an object"),e.delegate=null,f)}function _(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function x(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function S(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(_,this),this.reset(!0)}function P(t){if(t){var e=t[i];if(e)return e.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var n=-1,o=function e(){for(;++n<t.length;)if(r.call(t,n))return e.value=t[n],e.done=!1,e;return e.value=void 0,e.done=!0,e};return o.next=o}}return{next:L}}function L(){return{value:void 0,done:!0}}return p.prototype=d,n(g,"constructor",{value:d,configurable:!0}),n(d,"constructor",{value:p,configurable:!0}),p.displayName=c(d,u,"GeneratorFunction"),t.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===p||"GeneratorFunction"===(e.displayName||e.name))},t.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,d):(t.__proto__=d,c(t,u,"GeneratorFunction")),t.prototype=Object.create(g),t},t.awrap=function(t){return{__await:t}},b(E.prototype),c(E.prototype,a,(function(){return this})),t.AsyncIterator=E,t.async=function(e,r,n,o,i){void 0===i&&(i=Promise);var a=new E(l(e,r,n,o),i);return t.isGeneratorFunction(r)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},b(g),c(g,u,"Generator"),c(g,i,(function(){return this})),c(g,"toString",(function(){return"[object Generator]"})),t.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function t(){for(;r.length;){var n=r.pop();if(n in e)return t.value=n,t.done=!1,t}return t.done=!0,t}},t.values=P,S.prototype={constructor:S,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(x),!t)for(var e in this)"t"===e.charAt(0)&&r.call(this,e)&&!isNaN(+e.slice(1))&&(this[e]=void 0)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var e=this;function n(r,n){return a.type="throw",a.arg=t,e.next=r,n&&(e.method="next",e.arg=void 0),!!n}for(var o=this.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],a=i.completion;if("root"===i.tryLoc)return n("end");if(i.tryLoc<=this.prev){var u=r.call(i,"catchLoc"),c=r.call(i,"finallyLoc");if(u&&c){if(this.prev<i.catchLoc)return n(i.catchLoc,!0);if(this.prev<i.finallyLoc)return n(i.finallyLoc)}else if(u){if(this.prev<i.catchLoc)return n(i.catchLoc,!0)}else{if(!c)throw new Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return n(i.finallyLoc)}}}},abrupt:function(t,e){for(var n=this.tryEntries.length-1;n>=0;--n){var o=this.tryEntries[n];if(o.tryLoc<=this.prev&&r.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=t,a.arg=e,i?(this.method="next",this.next=i.finallyLoc,f):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),f},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),x(r),f}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var o=n.arg;x(r)}return o}}throw new Error("illegal catch attempt")},delegateYield:function(t,e,r){return this.delegate={iterator:P(t),resultName:e,nextLoc:r},"next"===this.method&&(this.arg=void 0),f}},t}function $t(t,e,r,n,o,i,a){try{var u=t[i](a),c=u.value}catch(t){return void r(t)}u.done?e(c):Promise.resolve(c).then(n,o)}function Zt(t){return function(){var e=this,r=arguments;return new Promise((function(n,o){var i=t.apply(e,r);function a(t){$t(i,n,o,a,u,"next",t)}function u(t){$t(i,n,o,a,u,"throw",t)}a(void 0)}))}}function te(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(void 0,o=function(t,e){if("object"!==Qt(t)||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,"string");if("object"!==Qt(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(n.key),"symbol"===Qt(o)?o:String(o)),n)}var o}function ee(){return ee="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,r){var n=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=oe(t)););return t}(t,e);if(n){var o=Object.getOwnPropertyDescriptor(n,e);return o.get?o.get.call(arguments.length<3?t:r):o.value}},ee.apply(this,arguments)}function re(t,e){return re=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},re(t,e)}function ne(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var r,n=oe(t);if(e){var o=oe(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return function(t,e){if(e&&("object"===Qt(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,r)}}function oe(t){return oe=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},oe(t)}var ie=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&re(t,e)}(u,t);var e,r,n,o,i,a=ne(u);function u(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,u),a.apply(this,arguments)}return e=u,r=[{key:"getExecutorName",value:function(){return x.SHOPIFY_ENCODED}},{key:"genExecuteActionsBeforeAutofill",value:(i=Zt(Jt().mark((function t(){var e;return Jt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!h){t.next=4;break}if(null===(e=document.documentElement)||this.isPromoCodeSuccess(e,this.promoCode,!1)){t.next=4;break}return t.abrupt("return");case 4:this.toggleOrderSummarySection(!0);case 5:case"end":return t.stop()}}),t,this)}))),function(){return i.apply(this,arguments)})},{key:"genObserveApplyPromoCodeResult",value:(o=Zt(Jt().mark((function t(e){var r,n,o=this;return Jt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(this.sendPromoExtensionPromoCodeAutofillResultForExecutor({result:O.INFO,event:_.PROMO_CODE_AUTOFILL_ATTEMPT,description:"Promo code autofill attempt"}),null!=(r=document.getElementById(P)||document.getElementById(L))){t.next=5;break}return this.sendPromoExtensionPromoCodeAutofillResultForExecutor({result:O.FAIL,event:_.NO_ORDER_SUMMARY_ELEMENT,description:"Cannot find order summary element"}),t.abrupt("return");case 5:if(null===(n=document.documentElement)||!this.isPromoCodeSuccess(n,e)&&!this.isErrorElementExist(n,e)){t.next=8;break}return t.abrupt("return");case 8:return t.abrupt("return",new Promise((function(t,n){Z("Starts to observe apply promo code");var i=!1,a=new MutationObserver((function(n){n.forEach((function(n){i||(o.isPromoCodeSuccess(r,e)||o.isErrorElementExist(r,e))&&(i=!0,a.disconnect(),t())}))}));window.setTimeout((function(){i||(o.isPromoCodeSuccess(r,e)||(o.sendPromoExtensionPromoCodeAutofillResultForExecutor({result:O.FAIL,event:_.OBSERVE_AUTOFILL_RESULT_TIMEOUT,description:"Timeout"}),h&&o.toggleOrderSummarySection(!1)),a.disconnect(),t())}),S),a.observe(r,{childList:!0,subtree:!0})})));case 9:case"end":return t.stop()}}),t,this)}))),function(t){return o.apply(this,arguments)})},{key:"genExecute",value:(n=Zt(Jt().mark((function t(){var e,r=this;return Jt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:ee(oe(u.prototype),"genExecute",this).call(this),e=this.getExecutorName(),it(T).then(Zt(Jt().mark((function t(){return Jt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,ft(200);case 2:return t.next=4,r.genHandlePromoCodeAutoFillRequest("element-exists-promo-autofill-".concat(e,"-")+c()());case 4:case"end":return t.stop()}}),t)})))).catch((function(t){Z("no order summary element")})),it(A).then(Zt(Jt().mark((function t(){return Jt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,ft(200);case 2:return t.next=4,r.genHandlePromoCodeAutoFillRequest("element-exists-promo-autofill-".concat(e,"-")+c()());case 4:case"end":return t.stop()}}),t)})))).catch((function(t){Z("no order summary element")}));case 4:case"end":return t.stop()}}),t,this)}))),function(){return n.apply(this,arguments)})},{key:"isPromoCodeSuccess",value:function(t,e){var r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];return!!function(t){return function(t){if(Array.isArray(t))return zt(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(t){if("string"==typeof t)return zt(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?zt(t,e):void 0}}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}(t.getElementsByTagName("button")).some((function(t){var r;return null===(r=t.getAttribute("aria-label"))||void 0===r?void 0:r.includes("".concat(e))}))&&(r&&this.sendPromoExtensionPromoCodeAutofillResultForExecutor({result:O.SUCCESS}),!0)}},{key:"isErrorElementExist",value:function(t,e){var r,n=null!==(r=t.getElementsByClassName("_7ozb2u1l").item(0))&&void 0!==r?r:t.getElementsByClassName("sdr03s1").item(0);if(null!=n){var o=n.textContent;null!==o&&""!==o||(o="unknown");var i=!1;return h&&(i=this.removeErrorElement(o)),i||this.sendPromoExtensionPromoCodeAutofillResultForExecutor({result:O.FAIL,event:_.HAS_PROMO_CODE_ERROR_ELEMENT,description:o}),!0}return!1}},{key:"removeErrorElement",value:function(t){var e=this;this.toggleOrderSummarySection(!0);var r=document.querySelector("button.sdr03s9._1fragemkj._1fragemjf._1fragemml");return null!==r?(r.click(),this.sendPromoExtensionPromoCodeAutofillResultForExecutor({result:O.FAIL,event:_.REMOVE_PROMO_CODE_ERROR_ELEMENT,description:t}),ft(300).then((function(){e.toggleOrderSummarySection(!1)})),!0):(this.toggleOrderSummarySection(!1),!1)}},{key:"toggleOrderSummarySection",value:function(t){var e=document.querySelector(T)||document.querySelector(A);t?"false"===(null==e?void 0:e.getAttribute("aria-expanded"))&&(null==e||e.click()):"true"===(null==e?void 0:e.getAttribute("aria-expanded"))&&(null==e||e.click())}}],r&&te(e.prototype,r),Object.defineProperty(e,"prototype",{writable:!1}),u}(Dt);function ae(t){return ae="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ae(t)}function ue(){/*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/facebook/regenerator/blob/main/LICENSE */ue=function(){return t};var t={},e=Object.prototype,r=e.hasOwnProperty,n=Object.defineProperty||function(t,e,r){t[e]=r.value},o="function"==typeof Symbol?Symbol:{},i=o.iterator||"@@iterator",a=o.asyncIterator||"@@asyncIterator",u=o.toStringTag||"@@toStringTag";function c(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{c({},"")}catch(t){c=function(t,e,r){return t[e]=r}}function l(t,e,r,o){var i=e&&e.prototype instanceof h?e:h,a=Object.create(i.prototype),u=new S(o||[]);return n(a,"_invoke",{value:w(t,r,u)}),a}function s(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}t.wrap=l;var f={};function h(){}function p(){}function d(){}var v={};c(v,i,(function(){return this}));var y=Object.getPrototypeOf,m=y&&y(y(P([])));m&&m!==e&&r.call(m,i)&&(v=m);var g=d.prototype=h.prototype=Object.create(v);function b(t){["next","throw","return"].forEach((function(e){c(t,e,(function(t){return this._invoke(e,t)}))}))}function E(t,e){function o(n,i,a,u){var c=s(t[n],t,i);if("throw"!==c.type){var l=c.arg,f=l.value;return f&&"object"==ae(f)&&r.call(f,"__await")?e.resolve(f.__await).then((function(t){o("next",t,a,u)}),(function(t){o("throw",t,a,u)})):e.resolve(f).then((function(t){l.value=t,a(l)}),(function(t){return o("throw",t,a,u)}))}u(c.arg)}var i;n(this,"_invoke",{value:function(t,r){function n(){return new e((function(e,n){o(t,r,e,n)}))}return i=i?i.then(n,n):n()}})}function w(t,e,r){var n="suspendedStart";return function(o,i){if("executing"===n)throw new Error("Generator is already running");if("completed"===n){if("throw"===o)throw i;return{value:void 0,done:!0}}for(r.method=o,r.arg=i;;){var a=r.delegate;if(a){var u=O(a,r);if(u){if(u===f)continue;return u}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if("suspendedStart"===n)throw n="completed",r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);n="executing";var c=s(t,e,r);if("normal"===c.type){if(n=r.done?"completed":"suspendedYield",c.arg===f)continue;return{value:c.arg,done:r.done}}"throw"===c.type&&(n="completed",r.method="throw",r.arg=c.arg)}}}function O(t,e){var r=e.method,n=t.iterator[r];if(void 0===n)return e.delegate=null,"throw"===r&&t.iterator.return&&(e.method="return",e.arg=void 0,O(t,e),"throw"===e.method)||"return"!==r&&(e.method="throw",e.arg=new TypeError("The iterator does not provide a '"+r+"' method")),f;var o=s(n,t.iterator,e.arg);if("throw"===o.type)return e.method="throw",e.arg=o.arg,e.delegate=null,f;var i=o.arg;return i?i.done?(e[t.resultName]=i.value,e.next=t.nextLoc,"return"!==e.method&&(e.method="next",e.arg=void 0),e.delegate=null,f):i:(e.method="throw",e.arg=new TypeError("iterator result is not an object"),e.delegate=null,f)}function _(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function x(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function S(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(_,this),this.reset(!0)}function P(t){if(t){var e=t[i];if(e)return e.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var n=-1,o=function e(){for(;++n<t.length;)if(r.call(t,n))return e.value=t[n],e.done=!1,e;return e.value=void 0,e.done=!0,e};return o.next=o}}return{next:L}}function L(){return{value:void 0,done:!0}}return p.prototype=d,n(g,"constructor",{value:d,configurable:!0}),n(d,"constructor",{value:p,configurable:!0}),p.displayName=c(d,u,"GeneratorFunction"),t.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===p||"GeneratorFunction"===(e.displayName||e.name))},t.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,d):(t.__proto__=d,c(t,u,"GeneratorFunction")),t.prototype=Object.create(g),t},t.awrap=function(t){return{__await:t}},b(E.prototype),c(E.prototype,a,(function(){return this})),t.AsyncIterator=E,t.async=function(e,r,n,o,i){void 0===i&&(i=Promise);var a=new E(l(e,r,n,o),i);return t.isGeneratorFunction(r)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},b(g),c(g,u,"Generator"),c(g,i,(function(){return this})),c(g,"toString",(function(){return"[object Generator]"})),t.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function t(){for(;r.length;){var n=r.pop();if(n in e)return t.value=n,t.done=!1,t}return t.done=!0,t}},t.values=P,S.prototype={constructor:S,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(x),!t)for(var e in this)"t"===e.charAt(0)&&r.call(this,e)&&!isNaN(+e.slice(1))&&(this[e]=void 0)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var e=this;function n(r,n){return a.type="throw",a.arg=t,e.next=r,n&&(e.method="next",e.arg=void 0),!!n}for(var o=this.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],a=i.completion;if("root"===i.tryLoc)return n("end");if(i.tryLoc<=this.prev){var u=r.call(i,"catchLoc"),c=r.call(i,"finallyLoc");if(u&&c){if(this.prev<i.catchLoc)return n(i.catchLoc,!0);if(this.prev<i.finallyLoc)return n(i.finallyLoc)}else if(u){if(this.prev<i.catchLoc)return n(i.catchLoc,!0)}else{if(!c)throw new Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return n(i.finallyLoc)}}}},abrupt:function(t,e){for(var n=this.tryEntries.length-1;n>=0;--n){var o=this.tryEntries[n];if(o.tryLoc<=this.prev&&r.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=t,a.arg=e,i?(this.method="next",this.next=i.finallyLoc,f):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),f},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),x(r),f}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var o=n.arg;x(r)}return o}}throw new Error("illegal catch attempt")},delegateYield:function(t,e,r){return this.delegate={iterator:P(t),resultName:e,nextLoc:r},"next"===this.method&&(this.arg=void 0),f}},t}function ce(t,e,r,n,o,i,a){try{var u=t[i](a),c=u.value}catch(t){return void r(t)}u.done?e(c):Promise.resolve(c).then(n,o)}function le(t){return function(){var e=this,r=arguments;return new Promise((function(n,o){var i=t.apply(e,r);function a(t){ce(i,n,o,a,u,"next",t)}function u(t){ce(i,n,o,a,u,"throw",t)}a(void 0)}))}}function se(t){if(t.includes("%"))return 0;var e=t.replace(/Rs\.|kr\./g,"");return e=e.indexOf(",")>e.indexOf(".")?e.replace(".","").replace(",","."):e.replace(/,/g,""),parseFloat(e.replace(/[^0-9.]/g,""))}function fe(t){return!!/^(?=.*\/checkout(?:s)?\/(?!$)(?=.*\/thank(_|-)you)|.*\/post_purchase|.*\/purchase\/thanks|.*completed=true)(?!.*\/checkout(?:s)?\/$).*/.test(t)||st("shopify")&&t.includes("/orders/")}function he(t){return pe.apply(this,arguments)}function pe(){return(pe=le(ue().mark((function t(e){var r,n,o,i,a,u,c;return ue().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(Z(e,"Extract Order Confirmation Page starts "),fe((r=window.location.href).toLowerCase())){t.next=5;break}return Z(e,"Extract Order Confirmation Page ends - Not a confirmation page - ",r),t.abrupt("return");case 5:return n=Jo()?x.SHOPIFY_ENCODED:zo()?x.SHOPIFY_STANDARD:x.GENERAL,t.next=8,de(50);case 8:if(0!==t.sent.length){t.next=12;break}return Z(e,"Extract Order Confirmation Page ends - cannot find Total element - ",r),t.abrupt("return");case 12:return o=ge(),i=be(),a=Ee(),u=me(),Z(e,"Payload for Order Confirmation Page",c=[{currency:o,total_savings:u,order_summary:i,product_details:a}]),I({result:y.INFO,event:m.ORDER_CONFIRMATION_PAGE_EXTRACT,description:"Extract Order Confirmation Page",executorType:n,url:r,metadata:JSON.stringify(c)}),R({result:y.INFO,event:m.ORDER_CONFIRMATION_PAGE_EXTRACT,description:"Extract Order Confirmation Page",executorType:n,url:r,metadata:JSON.stringify(c)}),Z(e,"Extract Order Confirmation Page ends"),t.abrupt("return");case 22:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function de(t){return ve.apply(this,arguments)}function ve(){return(ve=le(ue().mark((function t(e){var r,n;return ue().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:r=0;case 1:if(!(r<e)){t.next=10;break}return t.next=4,ft(150);case 4:if(!((n=ye())&&n.length>0)){t.next=7;break}return t.abrupt("return",n);case 7:r++,t.next=1;break;case 10:return Z("Failed to find total element after ".concat(e," retries")),t.abrupt("return","");case 12:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function ye(){var t,e=null!==(t=document.querySelector(".payment-due .payment-due__price"))&&void 0!==t?t:document.querySelector(".nfgb6p0 ._19gi7yt0._19gi7ytr._1fragemky._19gi7yt1");return e?e.textContent.trim():""}function me(){var t,e=null!==(t=document.querySelector(".total-savings__total"))&&void 0!==t?t:document.querySelector("strong._19gi7yt0._19gi7ytl._1fragemkv._19gi7yt1.notranslate");return e?se(e.textContent):0}function ge(){var t,e=null!==(t=document.querySelector(".payment-due__currency"))&&void 0!==t?t:document.querySelector(".nfgb6p0 ._19gi7yt0._19gi7ytj._1fragemku._19gi7ytb");return e?e.textContent.trim():""}function be(){var t,e,r,n,o,i,a,u,c,l,s={coupon_code:"",subtotal:0,order_level_discount:0,shipping:0,taxes:0,total:0},f=null!==(t=document.querySelector(".total-line--subtotal .total-line__price span"))&&void 0!==t?t:document.querySelector(".nfgb6p0 ._19gi7yt0._19gi7ytl._1fragemkv._19gi7yt1"),h=null!==(e=document.querySelector(".total-line--reduction .reduction-code__text"))&&void 0!==e?e:document.querySelector(".nfgb6p0 ._19gi7yt0._19gi7ytl._1fragemkv._19gi7ytb"),p=null!==(r=document.querySelector(".total-line--reduction .total-line__price span"))&&void 0!==r?r:null==h||null===(n=h.parentElement)||void 0===n||null===(o=n.parentElement)||void 0===o||null===(i=o.nextElementSibling)||void 0===i?void 0:i.querySelector("._19gi7yt0._19gi7ytl._1fragemkv"),d=null!==(a=null!==(u=document.querySelector(".total-line--shipping .total-line__price span"))&&void 0!==u?u:document.querySelector("._19gi7yt0._19gi7ytl._1fragemkv._19gi7ytf._19gi7yt1"))&&void 0!==a?a:document.querySelector("._19gi7yt0._19gi7ytl._1fragemkv._19gi7ytc._19gi7yt1"),v=null!==(c=document.querySelector(".total-line--taxes .total-line__price span"))&&void 0!==c?c:document.querySelector("._5uqybw2._1fragemkj._1fragemhx._1frageml4._1fragemlm._1fragemjd._1fragemjh._1fragemmn");if(f&&(s.subtotal=se(f.textContent)),p&&(s.order_level_discount=isNaN(se(p.textContent))?0:se(p.textContent)),d&&(s.shipping=isNaN(se(d.textContent))?0:se(d.textContent)),v){var y=v.getAttribute("data-checkout-total-taxes-target");null!==y&&"0"===y||(s.taxes=se(v.textContent))}return h&&(s.coupon_code=null!==(l=h.textContent.trim())&&void 0!==l?l:""),s.total=se(ye()),s}function Ee(){var t=function(){for(var t=[".sidebar tr.product","aside ._6zbcq524._1fragemkj._1fragem2i._6zbcq52b","tr.product"],e=document.querySelectorAll("this_is_a_hack_to_init_empty_node_list"),r=0;r<t.length&&!((e=document.querySelectorAll(t[r])).length>0);r++);return e}(),e=[];return t.forEach((function(t){var r,n,o,i,a,u,c,l,s,f,h,p,d=null!==(r=t.getAttribute("data-product-id"))&&void 0!==r?r:"",v=null!==(n=t.getAttribute("data-variant-id"))&&void 0!==n?n:"",y=null!==(o=t.getAttribute("data-product-type"))&&void 0!==o?o:"",m=null!==(i=t.querySelector(".product__description__name"))&&void 0!==i?i:t.querySelector("._1x52f9s1._1fragemir._1x52f9so._1fragemkv"),g=t.querySelector(".product__description__variant"),b=null!==(a=t.querySelector(".product__quantity span"))&&void 0!==a?a:t.querySelector("._99ss3s1 div"),E=null!==(u=t.querySelector(".product__price del"))&&void 0!==u?u:t.querySelector("._1fragemkj._1fragemkp._1fragemjg del"),w=null!==(c=null!==(l=null!==(s=t.querySelector(".product__price span.order-summary__emphasis"))&&void 0!==s?s:t.querySelector(".product__price span.order-summary__price"))&&void 0!==l?l:t.querySelector("._1fragemkj._1fragemkp._1fragemjg p"))&&void 0!==c?c:t.querySelector("._1fragemkj._1fragemkp._1fragemjg span"),O=null!==(f=t.querySelector(".reduction-code__text"))&&void 0!==f?f:t.querySelector("._1fragemir._1fragemkn._1frageml2 ._1x52f9s1"),_=m?m.textContent:"",x=g?g.textContent:"",S=b?b.textContent:"",P=0;w&&(P=isNaN(se(w.textContent))?0:se(w.textContent));var L=P;E&&(L=isNaN(se(E.textContent))?P:se(E.textContent));var N=O?null===(h=O.textContent)||void 0===h?void 0:h.split(" (")[0]:"",C=((L-P)/L).toFixed(2),T=(L-P).toFixed(2);e.push({product_id:d,variant_id:v,product_type:y,product_name:null!=_?_:"",variant_name:null!=x?x:"",quantity:parseFloat(S),price_before_discount:L,final_price:P,discount_code:null!==(p=N.trim())&&void 0!==p?p:"",discount_value:parseFloat(T),discount_percentage:parseFloat(C)})})),e}function we(){return location.protocol+"//"+location.host+location.pathname}function Oe(t){if(!t)return null;try{var e,r,n;"string"==typeof t&&(t=new URL(t));var o=null===(e=t)||void 0===e?void 0:e.protocol.toLowerCase(),i=null===(r=t)||void 0===r?void 0:r.hostname.toLowerCase(),a=null===(n=t)||void 0===n?void 0:n.pathname.replace(/\/$/,"");return"".concat(o,"//").concat(i).concat(a)}catch(e){return Z("Error reading the url - ".concat(t.toString()),e),null}}function _e(t){return _e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_e(t)}function xe(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(void 0,o=function(t,e){if("object"!==_e(t)||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,"string");if("object"!==_e(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(n.key),"symbol"===_e(o)?o:String(o)),n)}var o}var Se=function(t,e){return t-e},Pe=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:Se,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1/0;(function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")})(this,t),this.compare=e,this.queue=[],this.maxSize=r}var e,r;return e=t,(r=[{key:"size",value:function(){return this.queue.length}},{key:"peekFirst",value:function(){return this.queue[0]}},{key:"peekLast",value:function(){return this.queue.at(-1)}},{key:"add",value:function(t){var e=this,r=this.queue.findIndex((function(r){return e.compare(r,t)>=0}));r<0&&(r=this.size()),this.queue.splice(r,0,t),this.queue.length>this.maxSize&&this.queue.pop()}},{key:"contains",value:function(t){return this.queue.some((function(e){return e===t}))}},{key:"poll",value:function(){return this.queue.shift()}},{key:"show",value:function(){return this.queue}}])&&xe(e.prototype,r),Object.defineProperty(e,"prototype",{writable:!1}),t}();function Le(t){return Le="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Le(t)}function Ne(t,e){var r="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!r){if(Array.isArray(t)||(r=je(t))||e&&t&&"number"==typeof t.length){r&&(t=r);var n=0,o=function(){};return{s:o,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(t){throw t},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,u=!1;return{s:function(){r=r.call(t)},n:function(){var t=r.next();return a=t.done,t},e:function(t){u=!0,i=t},f:function(){try{a||null==r.return||r.return()}finally{if(u)throw i}}}}function Ce(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}function Te(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?Ce(Object(r),!0).forEach((function(e){Ue(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):Ce(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}function Ae(t){return function(t){if(Array.isArray(t))return ke(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||je(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function je(t,e){if(t){if("string"==typeof t)return ke(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?ke(t,e):void 0}}function ke(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function Ie(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,Ge(n.key),n)}}function Re(t,e,r){De(t,e),e.set(t,r)}function Fe(t,e){De(t,e),e.add(t)}function De(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function Ue(t,e,r){return(e=Ge(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Ge(t){var e=function(t,e){if("object"!==Le(t)||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,"string");if("object"!==Le(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"===Le(e)?e:String(e)}function Me(t,e){var r=function(t,e,r){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return e.get(t)}(t,e);return function(t,e){return e.get?e.get.call(t):e.value}(t,r)}function He(t,e,r){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return r}var Be=/\$ ?\d{1,3}(,\d{3})*(\.\d{2})?/g,qe=/\b(total|subtotal)\b/i,Ye="promo_extension_prices",We="promo_extension_url",Ke=/\b(fail|error|invalid|unable|unsuccessful|not\sapplied)\b/i,Ve=[".woocommerce-remove-coupon",".woocommerce-remove-coupon-nativecos"],Xe=function(t,e){return t.distance-e.distance},Qe=new WeakSet,ze=new WeakMap,Je=new WeakMap,$e=new WeakSet,Ze=new WeakSet,tr=new WeakSet,er=new WeakSet,rr=new WeakSet,nr=new WeakSet,or=new WeakSet,ir=new WeakSet,ar=new WeakSet,ur=new WeakSet,cr=new WeakSet,lr=function(){function t(e,r,n){var o,i=this;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),Fe(this,cr),Fe(this,ur),Fe(this,ar),Fe(this,ir),Fe(this,or),Fe(this,nr),Fe(this,rr),Fe(this,er),Fe(this,tr),Fe(this,Ze),Fe(this,$e),Fe(this,Qe),Ue(this,"resultFound",!1),Ue(this,"closestNodeCache",new Set),Ue(this,"sessionPrices",[]),Ue(this,"observer",null),Ue(this,"pasteObserved",!1),Ue(this,"allPriceElements",new Map),Ue(this,"logQueue",new Pe(Xe,5)),Ue(this,"autoApplyInstructions",null),Re(this,ze,{writable:!0,value:function(t){var e,r,n,o,a,u=t instanceof ClipboardEvent?null!==(e=null===(r=t.clipboardData)||void 0===r?void 0:r.getData("text/plain").toUpperCase())&&void 0!==e?e:"":null!==(n=null===(o=t.data)||void 0===o?void 0:o.toUpperCase())&&void 0!==n?n:"",c=null!==(a=i.promoCode.toUpperCase())&&void 0!==a?a:"";u&&u===c&&(i.pasteObserved||t.target instanceof HTMLElement&&(i.pasteObserved=!0,i.sendPromoExtensionTasksResult({result:y.INFO,event:m.OBSERVE_PASTE_EVENT,url:window.location.href,metadata:JSON.stringify({inputElement:t.target.className})}),t.target instanceof HTMLElement&&He(i,$e,fr).call(i,t.target),window.addEventListener("visibilitychange",Me(i,Je))))}}),Re(this,Je,{writable:!0,value:function(){if(Z("Unload Event",document.visibilityState),"hidden"===document.visibilityState)if(!i.resultFound&&i.pasteObserved){var t;if((null===(t=i.logQueue.peekFirst())||void 0===t?void 0:t.distance)<10)return void He(i,ar,gr).call(i,{description:"Logging before IAB close"});var e=Ae(He(i,er,pr).call(i,document.body).values());sessionStorage.setItem(Ye,JSON.stringify(e)),sessionStorage.setItem(We,we()),i.stopListening(!0)}else i.stopListening()}}),this.promoCode=null!=r?r:"",this.autoApplyInstructions=null!=n?n:null,this.signalType=e||"",(null!==(o=sessionStorage.getItem(We))&&void 0!==o?o:"")===we()&&(this.sessionPrices=JSON.parse(sessionStorage.getItem(Ye)||"")||[]),this.startListening()}var e,r;return e=t,r=[{key:"startListening",value:function(){switch(this.signalType){case"copy_paste":if(this.sessionPrices.length){He(this,Qe,sr).call(this);break}document.addEventListener("paste",Me(this,ze)),J()===a.ANDROID&&document.addEventListener("input",Me(this,ze))}}},{key:"stopListening",value:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];"copy_paste"===this.signalType&&(document.removeEventListener("paste",Me(this,ze)),window.removeEventListener("visibilitychange",Me(this,Je)),this.observer&&this.observer.disconnect(),this.pasteObserved=!1,this.resultFound=!0,t||(sessionStorage.removeItem(Ye),sessionStorage.removeItem(We)),e&&this.startListening())}},{key:"sendPromoExtensionTasksResult",value:function(t){var e,r=JSON.parse(null!==(e=t.metadata)&&void 0!==e?e:"{}");r.promoCode=this.promoCode,r.version="USD_ONLY",R(Te(Te({},t),{},{metadata:JSON.stringify(r)}))}}],r&&Ie(e.prototype,r),Object.defineProperty(e,"prototype",{writable:!1}),t}();function sr(){var t,e,r,n,o=Ae(He(this,er,pr).call(this,document.body).values());o.at(-1)!==this.sessionPrices.at(-1)&&o.length?He(this,or,yr).call(this,g.FOUND_PRICE_CHANGE,{confidence:E.LOW,oldPrice:null!==(t=null===(e=this.sessionPrices.at(-1))||void 0===e?void 0:e.trim())&&void 0!==t?t:"",newPrice:null!==(r=null===(n=o.at(-1))||void 0===n?void 0:n.trim())&&void 0!==r?r:"",description:"Log After a Reload Event"}):this.stopListening(!1,!0)}function fr(t){var e,r;this.resultFound=!1,this.inputElement=t,this.summaryElement=null!==(e=He(this,tr,hr).call(this,t))&&void 0!==e?e:document.body,this.allPriceElements=He(this,er,pr).call(this,this.summaryElement),this.targetSelector="#".concat(t.getAttribute("id")||"",".").concat((null===(r=t.classList)||void 0===r?void 0:r[0])||""),Z("Input Element",this.inputElement),Z("Order Summary: ",this.summaryElement),Z("Prices: ",this.allPriceElements.entries()),this.summaryElement===document.body&&He(this,ar,gr).call(this,{description:g.NO_SUMMARY_ELEMENT_FOUND}),He(this,nr,vr).call(this,this.summaryElement)}function hr(t){var e,r,n,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:20;if(!o)return null;if(!(t&&t instanceof HTMLElement))return null;var i=null===(e=t.innerText)||void 0===e?void 0:e.match(qe),a=null===(r=t.innerText)||void 0===r?void 0:r.match(Be);return i&&a?t:He(this,tr,hr).call(this,null!==(n=t.parentNode)&&void 0!==n?n:null,o-1)}function pr(t){var e,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new Map,n=!1;if(null==t||null===(e=t.childNodes)||void 0===e||!e.length)return r;var o,i=Ne(t.childNodes);try{for(i.s();!(o=i.n()).done;){var a,u=o.value;["SCRIPT","IFRAME","STYLE","LINK","HEAD","META","TITLE"].includes(u.nodeName)||null!==(a=u.innerText)&&void 0!==a&&a.match(Be)&&(n=!0,He(this,er,pr).call(this,u,r))}}catch(t){i.e(t)}finally{i.f()}var c=t.textContent.trim();return!n&&c.length<100&&r.set(t,c),r}function dr(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if(t&&e&&!this.resultFound)if(this.allPriceElements.has(e)){var r=this.allPriceElements.get(e),n=t.textContent.trim();r!==n&&n.match(Be)&&(Z("Success","Found Cloned Order Summary Element"),He(this,or,yr).call(this,g.FOUND_PRICE_CHANGE,{description:"Found Cloned Order Summary Element",confidence:E.MEDIUM,oldPrice:null!=r?r:"",newPrice:n,signalLog:He(this,ir,mr).call(this)}))}else for(var o=0;o<e.childNodes.length;o++)He(this,rr,dr).call(this,t.childNodes[o],e.childNodes[o])}function vr(t){var e,r=this;this.observer=new MutationObserver((function(e,n){if(!r.resultFound){var o,i=Ne(e.reverse());try{var a=function(){var t=o.value;if(r.allPriceElements.forEach((function(e,n){if(!r.resultFound)if(n.contains(t.target)){var o=n.textContent.trim();!r.resultFound&&e!==o&&o.match(Be)&&He(r,or,yr).call(r,g.FOUND_PRICE_CHANGE,{description:"Found Exact Price Element",confidence:E.HIGH,oldPrice:e,newPrice:o,signalLog:He(r,ir,mr).call(r)})}else if(t.removedNodes.length&&Ae(t.removedNodes).some((function(t){return n.contains(t)})))for(var i=0,a=Ae(t.addedNodes);i<a.length;i++){var u=a[i].textContent.trim();r.resultFound||e===u||He(r,or,yr).call(r,g.FOUND_PRICE_CHANGE,{description:"Found Cloned Price Element",confidence:E.MEDIUM,oldPrice:e,newPrice:u,signalLog:He(r,ir,mr).call(r)})}else if("childList"===t.type&&t.target===r.summaryElement)for(var c=0;c<t.addedNodes.length;c++){if(r.resultFound)return;He(r,rr,dr).call(r,t.addedNodes[c],t.removedNodes[c])}})),"childList"===t.type&&t.target===r.summaryElement)for(var e=0;e<t.addedNodes.length;e++){if(r.resultFound)return{v:void 0};He(r,rr,dr).call(r,t.addedNodes[e],t.removedNodes[e])}};for(i.s();!(o=i.n()).done;){var u=a();if("object"===Le(u))return u.v}}catch(t){i.e(t)}finally{i.f()}if(!r.resultFound){var c,l=He(r,tr,hr).call(r,t),s=Ne(e);try{for(s.s();!(c=s.n()).done;){var f=c.value;if("childList"===f.type){var h,p=Ne(f.addedNodes);try{for(p.s();!(h=p.n()).done;){var d=h.value;if(!r.closestNodeCache.has(d)){var v=null!=l&&l.contains(r.inputElement)?r.inputElement:null==l?void 0:l.querySelector(r.targetSelector),y=He(r,cr,Er).call(r,d,v);(r.logQueue.size()<5||y<r.logQueue.peekLast().distance)&&(null!=d&&d.innerText||(null==d?void 0:d.nodeType)===Node.TEXT_NODE&&null!=d&&d.textContent.trim())?r.logQueue.add({distance:y,node:d}):r.closestNodeCache.add(d)}}}catch(t){p.e(t)}finally{p.f()}}}}catch(t){s.e(t)}finally{s.f()}for(var m=0,b=Ve;m<b.length;m++){var w=b[m];if(r.resultFound)return;document.querySelector(w)&&He(r,or,yr).call(r,g.FOUND_3RD_PARTY_SELECTOR,{confidence:E.HIGH,signalLog:He(r,ir,mr).call(r)})}}}})),setTimeout((function(){r.observer&&He(r,ar,gr).call(r)}),8e3),t&&(null===(e=this.observer)||void 0===e||e.observe(t,{childList:!0,subtree:!0,attributes:!0,characterData:!0,characterDataOldValue:!0}))}function yr(t,e){var r=this;this.resultFound||(setTimeout((function(){r.sendPromoExtensionTasksResult(Te({result:y.INFO,url:window.location.href,event:m.COUPON_SIGNAL_APPLY_SUCCESS,metadata:JSON.stringify(e),description:t},D(r.autoApplyInstructions)))}),1e3),this.stopListening(),this.resultFound=!0)}function mr(){for(var t=[];this.logQueue.size();){var e;if(!((null===(e=this.logQueue.peekFirst())||void 0===e?void 0:e.distance)<100))break;var r=He(this,ur,br).call(this,this.logQueue.poll().node);t.push(r.substring(0,250))}return t}function gr(t){var e=this;if(!this.resultFound){var r=He(this,ir,mr).call(this),n=r.join(" "),o=Te(Te({},t),{},{signalLog:r});n.match(Ke)&&(o.confidence=E.HIGH),setTimeout((function(){e.sendPromoExtensionTasksResult(Te({result:y.INFO,url:window.location.href,event:r.length?m.COUPON_SIGNAL_APPLY_FAIL:m.COUPON_SIGNAL_CAPTURE_FAIL,description:r.length?g.FOUND_ERROR_DESCRIPTION:g.TIMEOUT,metadata:JSON.stringify(o)},D(e.autoApplyInstructions)))}),1e3),Z("Error Log",r),this.stopListening()}}function br(t){var e="";if(t.childNodes&&t.childNodes.length){var r,n=Ne(t.childNodes);try{for(n.s();!(r=n.n()).done;){var o=r.value;o.nodeType===Node.TEXT_NODE?e+=o.textContent:e+=He(this,ur,br).call(this,o)}}catch(t){n.e(t)}finally{n.f()}}else e=t.textContent;return e.replace(/\s+/g," ")}function Er(){var t,e,r,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new Map,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;return n&&o?n===o?2*a:"BUTTON"===n.nodeName||"BUTTON"===o.nodeName||this.logQueue.size()>=5&&a>(null===(t=this.logQueue.peekLast())||void 0===t?void 0:t.distance)?1/0:i.has(n)?(null!==(e=i.get(n))&&void 0!==e?e:1/0)+a:i.has(o)?(null!==(r=i.get(o))&&void 0!==r?r:1/0)+a:(i.set(n,a),i.set(o,a),He(this,cr,Er).call(this,null==n?void 0:n.parentNode,null==o?void 0:o.parentNode,i,a+1)):1/0}var wr=[];function Or(t){return Or="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Or(t)}function _r(t,e){var r="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!r){if(Array.isArray(t)||(r=Lr(t))||e&&t&&"number"==typeof t.length){r&&(t=r);var n=0,o=function(){};return{s:o,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(t){throw t},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,u=!1;return{s:function(){r=r.call(t)},n:function(){var t=r.next();return a=t.done,t},e:function(t){u=!0,i=t},f:function(){try{a||null==r.return||r.return()}finally{if(u)throw i}}}}function xr(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}function Sr(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?xr(Object(r),!0).forEach((function(e){kr(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):xr(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}function Pr(t){return function(t){if(Array.isArray(t))return Nr(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||Lr(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Lr(t,e){if(t){if("string"==typeof t)return Nr(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?Nr(t,e):void 0}}function Nr(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function Cr(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,Ir(n.key),n)}}function Tr(t,e,r){jr(t,e),e.set(t,r)}function Ar(t,e){jr(t,e),e.add(t)}function jr(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")}function kr(t,e,r){return(e=Ir(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Ir(t){var e=function(t,e){if("object"!==Or(t)||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,"string");if("object"!==Or(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"===Or(e)?e:String(e)}function Rr(t,e){var r=function(t,e,r){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return e.get(t)}(t,e);return function(t,e){return e.get?e.get.call(t):e.value}(t,r)}function Fr(t,e,r){if(!e.has(t))throw new TypeError("attempted to get private field on non-instance");return r}var Dr=/(([1-9]{1,3}(,\d{3})*(\.\d{2})?)|(0\.[1-9]\d)|(0\.0[1-9]))?|\$ ?\d{1,3}(,\d{3})*(\.\d{2})?/g,Ur=/\b(total|subtotal)\b/i,Gr="promo_extension_prices_test",Mr="promo_extension_url_test",Hr=/\b(fail|error|invalid|unable|unsuccessful|not\sapplied)\b/i,Br=[".woocommerce-remove-coupon",".woocommerce-remove-coupon-nativecos"],qr=function(t,e){return t.distance-e.distance},Yr=new WeakSet,Wr=new WeakMap,Kr=new WeakMap,Vr=new WeakSet,Xr=new WeakSet,Qr=new WeakSet,zr=new WeakSet,Jr=new WeakSet,$r=new WeakSet,Zr=new WeakSet,tn=new WeakSet,en=new WeakSet,rn=new WeakSet,nn=new WeakSet,on=function(){function t(e,r,n){var o,i=this;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),Ar(this,nn),Ar(this,rn),Ar(this,en),Ar(this,tn),Ar(this,Zr),Ar(this,$r),Ar(this,Jr),Ar(this,zr),Ar(this,Qr),Ar(this,Xr),Ar(this,Vr),Ar(this,Yr),kr(this,"resultFound",!1),kr(this,"closestNodeCache",new Set),kr(this,"sessionPrices",[]),kr(this,"observer",null),kr(this,"pasteObserved",!1),kr(this,"allPriceElements",new Map),kr(this,"logQueue",new Pe(qr,5)),kr(this,"autoApplyInstructions",null),Tr(this,Wr,{writable:!0,value:function(t){var e,r,n,o,a,u=t instanceof ClipboardEvent?null!==(e=null===(r=t.clipboardData)||void 0===r?void 0:r.getData("text/plain").toUpperCase())&&void 0!==e?e:"":null!==(n=null===(o=t.data)||void 0===o?void 0:o.toUpperCase())&&void 0!==n?n:"",c=null!==(a=i.promoCode.toUpperCase())&&void 0!==a?a:"";u&&u===c&&(i.pasteObserved||t.target instanceof HTMLElement&&(i.pasteObserved=!0,i.sendPromoExtensionTasksResult({result:y.INFO,event:m.OBSERVE_PASTE_EVENT,url:window.location.href,metadata:JSON.stringify({inputElement:t.target.className})}),t.target instanceof HTMLElement&&Fr(i,Vr,un).call(i,t.target),window.addEventListener("visibilitychange",Rr(i,Kr))))}}),Tr(this,Kr,{writable:!0,value:function(){if(Z("Unload Event",document.visibilityState),"hidden"===document.visibilityState)if(!i.resultFound&&i.pasteObserved){var t;if((null===(t=i.logQueue.peekFirst())||void 0===t?void 0:t.distance)<10)return void Fr(i,en,dn).call(i,{description:"Logging before IAB close"});var e=Pr(Fr(i,zr,ln).call(i,document.body).values());sessionStorage.setItem(Gr,JSON.stringify(e)),sessionStorage.setItem(Mr,we()),i.stopListening(!0)}else i.stopListening()}}),this.promoCode=null!=r?r:"",this.autoApplyInstructions=null!=n?n:null,this.signalType=e||"",(null!==(o=sessionStorage.getItem(Mr))&&void 0!==o?o:"")===we()&&(this.sessionPrices=JSON.parse(sessionStorage.getItem(Gr)||"")||[]),this.startListening()}var e,r;return e=t,r=[{key:"startListening",value:function(){switch(this.signalType){case"copy_paste":if(this.sessionPrices.length){Fr(this,Yr,an).call(this);break}document.addEventListener("paste",Rr(this,Wr)),J()===a.ANDROID&&document.addEventListener("input",Rr(this,Wr))}}},{key:"stopListening",value:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];"copy_paste"===this.signalType&&(document.removeEventListener("paste",Rr(this,Wr)),window.removeEventListener("visibilitychange",Rr(this,Kr)),this.observer&&this.observer.disconnect(),this.pasteObserved=!1,this.resultFound=!0,t||(sessionStorage.removeItem(Gr),sessionStorage.removeItem(Mr)),e&&this.startListening())}},{key:"sendPromoExtensionTasksResult",value:function(t){var e,r=JSON.parse(null!==(e=t.metadata)&&void 0!==e?e:"{}");r.promoCode=this.promoCode,r.version="logging_update_06:04",R(Sr(Sr({},t),{},{metadata:JSON.stringify(r)}))}}],r&&Cr(e.prototype,r),Object.defineProperty(e,"prototype",{writable:!1}),t}();function an(){var t,e,r,n,o=Pr(Fr(this,zr,ln).call(this,document.body).values());o.at(-1)!==this.sessionPrices.at(-1)&&o.length?Fr(this,Zr,hn).call(this,g.FOUND_PRICE_CHANGE,{confidence:E.LOW,oldPrice:null!==(t=null===(e=this.sessionPrices.at(-1))||void 0===e?void 0:e.trim())&&void 0!==t?t:"",newPrice:null!==(r=null===(n=o.at(-1))||void 0===n?void 0:n.trim())&&void 0!==r?r:"",description:"Log After a Reload Event"}):this.stopListening(!1,!0)}function un(t){var e,r;this.resultFound=!1,this.inputElement=t,this.summaryElement=null!==(e=Fr(this,Qr,cn).call(this,t))&&void 0!==e?e:document.body,this.allPriceElements=Fr(this,zr,ln).call(this,this.summaryElement),this.targetSelector="#".concat(t.getAttribute("id")||"",".").concat((null===(r=t.classList)||void 0===r?void 0:r[0])||""),Z("Input Element",this.inputElement),Z("Order Summary: ",this.summaryElement),Z("Prices: ",this.allPriceElements.entries()),this.summaryElement===document.body&&Fr(this,en,dn).call(this,{description:g.NO_SUMMARY_ELEMENT_FOUND}),Fr(this,$r,fn).call(this,this.summaryElement)}function cn(t){var e,r,n,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:20;if(!o)return null;if(!(t&&t instanceof HTMLElement))return null;var i=null===(e=t.innerText)||void 0===e?void 0:e.match(Ur),a=null===(r=t.innerText)||void 0===r?void 0:r.match(Dr);return i&&a?t:Fr(this,Qr,cn).call(this,null!==(n=t.parentNode)&&void 0!==n?n:null,o-1)}function ln(t){var e,r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new Map,n=!1;if(null==t||null===(e=t.childNodes)||void 0===e||!e.length)return r;var o,i=_r(t.childNodes);try{for(i.s();!(o=i.n()).done;){var a,u=o.value;["SCRIPT","IFRAME","STYLE","LINK","HEAD","META","TITLE"].includes(u.nodeName)||null!==(a=u.innerText)&&void 0!==a&&a.match(Dr)&&(n=!0,Fr(this,zr,ln).call(this,u,r))}}catch(t){i.e(t)}finally{i.f()}var c=t.textContent.trim();return!n&&c.length<100&&r.set(t,c),r}function sn(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if(t&&e&&!this.resultFound)if(this.allPriceElements.has(e)){var r=this.allPriceElements.get(e),n=t.textContent.trim();r!==n&&n.match(Dr)&&(Z("Success","Found Cloned Order Summary Element"),Fr(this,Zr,hn).call(this,g.FOUND_PRICE_CHANGE,{description:"Found Cloned Order Summary Element",confidence:E.MEDIUM,oldPrice:null!=r?r:"",newPrice:n,signalLog:Fr(this,tn,pn).call(this)}))}else for(var o=0;o<e.childNodes.length;o++)Fr(this,Jr,sn).call(this,t.childNodes[o],e.childNodes[o])}function fn(t){var e,r=this;this.observer=new MutationObserver((function(e,n){if(!r.resultFound){var o,i=_r(e.reverse());try{var a=function(){var t=o.value;if(r.allPriceElements.forEach((function(e,n){if(!r.resultFound)if(n.contains(t.target)){var o=n.textContent.trim();!r.resultFound&&e!==o&&o.match(Dr)&&Fr(r,Zr,hn).call(r,g.FOUND_PRICE_CHANGE,{description:"Found Exact Price Element",confidence:E.HIGH,oldPrice:e,newPrice:o,signalLog:Fr(r,tn,pn).call(r)})}else if(t.removedNodes.length&&Pr(t.removedNodes).some((function(t){return n.contains(t)})))for(var i=0,a=Pr(t.addedNodes);i<a.length;i++){var u=a[i].textContent.trim();r.resultFound||e===u||Fr(r,Zr,hn).call(r,g.FOUND_PRICE_CHANGE,{description:"Found Cloned Price Element",confidence:E.MEDIUM,oldPrice:e,newPrice:u,signalLog:Fr(r,tn,pn).call(r)})}else if("childList"===t.type&&t.target===r.summaryElement)for(var c=0;c<t.addedNodes.length;c++){if(r.resultFound)return;Fr(r,Jr,sn).call(r,t.addedNodes[c],t.removedNodes[c])}})),"childList"===t.type&&t.target===r.summaryElement)for(var e=0;e<t.addedNodes.length;e++){if(r.resultFound)return{v:void 0};Fr(r,Jr,sn).call(r,t.addedNodes[e],t.removedNodes[e])}};for(i.s();!(o=i.n()).done;){var u=a();if("object"===Or(u))return u.v}}catch(t){i.e(t)}finally{i.f()}if(!r.resultFound){var c,l=Fr(r,Qr,cn).call(r,t),s=_r(e);try{for(s.s();!(c=s.n()).done;){var f=c.value;if("childList"===f.type){var h,p=_r(f.addedNodes);try{for(p.s();!(h=p.n()).done;){var d=h.value;if(!r.closestNodeCache.has(d)){var v=null!=l&&l.contains(r.inputElement)?r.inputElement:null==l?void 0:l.querySelector(r.targetSelector),y=Fr(r,nn,yn).call(r,d,v);(r.logQueue.size()<5||y<r.logQueue.peekLast().distance)&&(null!=d&&d.innerText||(null==d?void 0:d.nodeType)===Node.TEXT_NODE&&null!=d&&d.textContent.trim())?r.logQueue.add({distance:y,node:d}):r.closestNodeCache.add(d)}}}catch(t){p.e(t)}finally{p.f()}}}}catch(t){s.e(t)}finally{s.f()}for(var m=0,b=Br;m<b.length;m++){var w=b[m];if(r.resultFound)return;document.querySelector(w)&&Fr(r,Zr,hn).call(r,g.FOUND_3RD_PARTY_SELECTOR,{confidence:E.HIGH,signalLog:Fr(r,tn,pn).call(r)})}}}})),setTimeout((function(){r.observer&&Fr(r,en,dn).call(r)}),8e3),t&&(null===(e=this.observer)||void 0===e||e.observe(t,{childList:!0,subtree:!0,attributes:!0,characterData:!0,characterDataOldValue:!0}))}function hn(t,e){var r=this;this.resultFound||(setTimeout((function(){r.sendPromoExtensionTasksResult(Sr({result:y.INFO,url:window.location.href,event:m.COUPON_SIGNAL_APPLY_SUCCESS,metadata:JSON.stringify(e),description:t},D(r.autoApplyInstructions)))}),1e3),this.stopListening(),this.resultFound=!0)}function pn(){for(var t=[];this.logQueue.size();){var e;if(!((null===(e=this.logQueue.peekFirst())||void 0===e?void 0:e.distance)<100))break;var r=Fr(this,rn,vn).call(this,this.logQueue.poll().node);t.push(r.substring(0,250))}return t}function dn(t){var e=this;if(!this.resultFound){var r=Fr(this,tn,pn).call(this),n=r.join(" "),o=Sr(Sr({},t),{},{signalLog:r});n.match(Hr)&&(o.confidence=E.HIGH),setTimeout((function(){e.sendPromoExtensionTasksResult(Sr({result:y.INFO,url:window.location.href,event:r.length?m.COUPON_SIGNAL_APPLY_FAIL:m.COUPON_SIGNAL_CAPTURE_FAIL,description:r.length?g.FOUND_ERROR_DESCRIPTION:g.TIMEOUT,metadata:JSON.stringify(o)},D(e.autoApplyInstructions)))}),1e3),Z("Error Log",r),this.stopListening()}}function vn(t){var e="";if(t.childNodes&&t.childNodes.length){var r,n=_r(t.childNodes);try{for(n.s();!(r=n.n()).done;){var o=r.value;o.nodeType===Node.TEXT_NODE?e+=o.textContent:e+=Fr(this,rn,vn).call(this,o)}}catch(t){n.e(t)}finally{n.f()}}else e=t.textContent;return e.replace(/\s+/g," ")}function yn(){var t,e,r,n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:new Map,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;return n&&o?n===o?2*a:"BUTTON"===n.nodeName||"BUTTON"===o.nodeName||this.logQueue.size()>=5&&a>(null===(t=this.logQueue.peekLast())||void 0===t?void 0:t.distance)?1/0:i.has(n)?(null!==(e=i.get(n))&&void 0!==e?e:1/0)+a:i.has(o)?(null!==(r=i.get(o))&&void 0!==r?r:1/0)+a:(i.set(n,a),i.set(o,a),Fr(this,nn,yn).call(this,null==n?void 0:n.parentNode,null==o?void 0:o.parentNode,i,a+1)):1/0}function mn(t,e,r,n){t===b.PASTE&&(Z("Starting paste event task"),wr.push(new lr(e,r,n),new on(e,r,n)))}function gn(t){return gn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},gn(t)}function bn(){/*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/facebook/regenerator/blob/main/LICENSE */bn=function(){return t};var t={},e=Object.prototype,r=e.hasOwnProperty,n=Object.defineProperty||function(t,e,r){t[e]=r.value},o="function"==typeof Symbol?Symbol:{},i=o.iterator||"@@iterator",a=o.asyncIterator||"@@asyncIterator",u=o.toStringTag||"@@toStringTag";function c(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{c({},"")}catch(t){c=function(t,e,r){return t[e]=r}}function l(t,e,r,o){var i=e&&e.prototype instanceof h?e:h,a=Object.create(i.prototype),u=new S(o||[]);return n(a,"_invoke",{value:w(t,r,u)}),a}function s(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}t.wrap=l;var f={};function h(){}function p(){}function d(){}var v={};c(v,i,(function(){return this}));var y=Object.getPrototypeOf,m=y&&y(y(P([])));m&&m!==e&&r.call(m,i)&&(v=m);var g=d.prototype=h.prototype=Object.create(v);function b(t){["next","throw","return"].forEach((function(e){c(t,e,(function(t){return this._invoke(e,t)}))}))}function E(t,e){function o(n,i,a,u){var c=s(t[n],t,i);if("throw"!==c.type){var l=c.arg,f=l.value;return f&&"object"==gn(f)&&r.call(f,"__await")?e.resolve(f.__await).then((function(t){o("next",t,a,u)}),(function(t){o("throw",t,a,u)})):e.resolve(f).then((function(t){l.value=t,a(l)}),(function(t){return o("throw",t,a,u)}))}u(c.arg)}var i;n(this,"_invoke",{value:function(t,r){function n(){return new e((function(e,n){o(t,r,e,n)}))}return i=i?i.then(n,n):n()}})}function w(t,e,r){var n="suspendedStart";return function(o,i){if("executing"===n)throw new Error("Generator is already running");if("completed"===n){if("throw"===o)throw i;return{value:void 0,done:!0}}for(r.method=o,r.arg=i;;){var a=r.delegate;if(a){var u=O(a,r);if(u){if(u===f)continue;return u}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if("suspendedStart"===n)throw n="completed",r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);n="executing";var c=s(t,e,r);if("normal"===c.type){if(n=r.done?"completed":"suspendedYield",c.arg===f)continue;return{value:c.arg,done:r.done}}"throw"===c.type&&(n="completed",r.method="throw",r.arg=c.arg)}}}function O(t,e){var r=e.method,n=t.iterator[r];if(void 0===n)return e.delegate=null,"throw"===r&&t.iterator.return&&(e.method="return",e.arg=void 0,O(t,e),"throw"===e.method)||"return"!==r&&(e.method="throw",e.arg=new TypeError("The iterator does not provide a '"+r+"' method")),f;var o=s(n,t.iterator,e.arg);if("throw"===o.type)return e.method="throw",e.arg=o.arg,e.delegate=null,f;var i=o.arg;return i?i.done?(e[t.resultName]=i.value,e.next=t.nextLoc,"return"!==e.method&&(e.method="next",e.arg=void 0),e.delegate=null,f):i:(e.method="throw",e.arg=new TypeError("iterator result is not an object"),e.delegate=null,f)}function _(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function x(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function S(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(_,this),this.reset(!0)}function P(t){if(t){var e=t[i];if(e)return e.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var n=-1,o=function e(){for(;++n<t.length;)if(r.call(t,n))return e.value=t[n],e.done=!1,e;return e.value=void 0,e.done=!0,e};return o.next=o}}return{next:L}}function L(){return{value:void 0,done:!0}}return p.prototype=d,n(g,"constructor",{value:d,configurable:!0}),n(d,"constructor",{value:p,configurable:!0}),p.displayName=c(d,u,"GeneratorFunction"),t.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===p||"GeneratorFunction"===(e.displayName||e.name))},t.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,d):(t.__proto__=d,c(t,u,"GeneratorFunction")),t.prototype=Object.create(g),t},t.awrap=function(t){return{__await:t}},b(E.prototype),c(E.prototype,a,(function(){return this})),t.AsyncIterator=E,t.async=function(e,r,n,o,i){void 0===i&&(i=Promise);var a=new E(l(e,r,n,o),i);return t.isGeneratorFunction(r)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},b(g),c(g,u,"Generator"),c(g,i,(function(){return this})),c(g,"toString",(function(){return"[object Generator]"})),t.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function t(){for(;r.length;){var n=r.pop();if(n in e)return t.value=n,t.done=!1,t}return t.done=!0,t}},t.values=P,S.prototype={constructor:S,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(x),!t)for(var e in this)"t"===e.charAt(0)&&r.call(this,e)&&!isNaN(+e.slice(1))&&(this[e]=void 0)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var e=this;function n(r,n){return a.type="throw",a.arg=t,e.next=r,n&&(e.method="next",e.arg=void 0),!!n}for(var o=this.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],a=i.completion;if("root"===i.tryLoc)return n("end");if(i.tryLoc<=this.prev){var u=r.call(i,"catchLoc"),c=r.call(i,"finallyLoc");if(u&&c){if(this.prev<i.catchLoc)return n(i.catchLoc,!0);if(this.prev<i.finallyLoc)return n(i.finallyLoc)}else if(u){if(this.prev<i.catchLoc)return n(i.catchLoc,!0)}else{if(!c)throw new Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return n(i.finallyLoc)}}}},abrupt:function(t,e){for(var n=this.tryEntries.length-1;n>=0;--n){var o=this.tryEntries[n];if(o.tryLoc<=this.prev&&r.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=t,a.arg=e,i?(this.method="next",this.next=i.finallyLoc,f):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),f},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),x(r),f}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var o=n.arg;x(r)}return o}}throw new Error("illegal catch attempt")},delegateYield:function(t,e,r){return this.delegate={iterator:P(t),resultName:e,nextLoc:r},"next"===this.method&&(this.arg=void 0),f}},t}function En(t,e,r,n,o,i,a){try{var u=t[i](a),c=u.value}catch(t){return void r(t)}u.done?e(c):Promise.resolve(c).then(n,o)}function wn(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(void 0,o=function(t,e){if("object"!==gn(t)||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,"string");if("object"!==gn(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(n.key),"symbol"===gn(o)?o:String(o)),n)}var o}var On=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)}var e,r,n,o;return e=t,r=[{key:"getExtractorName",value:function(){return x.GENERAL}},{key:"genExtract",value:(n=bn().mark((function t(){var e,r,n,o,i,a,u=this;return bn().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e=this.getExtractorName(),r=window.location.href,this.isCheckoutPage(r.toLowerCase())){t.next=5;break}return Z("".concat(e," - Extract Checkout Page (Not a checkout page) - END"),r),t.abrupt("return");case 5:if(null!=(n=this.getOrderSummaryElement())){t.next=9;break}return Z("".concat(e," - Extract Checkout Page (no order summary) - END ")),t.abrupt("return");case 9:return o={attributes:!0,childList:!0,subtree:!0},i=!1,(a=new MutationObserver((function(t){t.forEach((function(t){if(!i){var o=u.extractCouponCodeElement(n);if(""!==o){var c=[{order_summary:{coupon_code:o}}];Z("".concat(e," - Extract Checkout Page - PAYLOAD: "),c),I({result:y.INFO,event:m.CHECKOUT_PAGE_EXTRACT,description:"Extract Checkout Page",executorType:e,url:r,metadata:JSON.stringify(c)}),i=!0,Z("".concat(e," - Extract Checkout Page - END ")),a.disconnect()}}}))}))).observe(n,o),Z("".concat(e," - Extract Checkout Page - START OBSERVING ... ")),t.abrupt("return");case 15:case"end":return t.stop()}}),t,this)})),o=function(){var t=this,e=arguments;return new Promise((function(r,o){var i=n.apply(t,e);function a(t){En(i,r,o,a,u,"next",t)}function u(t){En(i,r,o,a,u,"throw",t)}a(void 0)}))},function(){return o.apply(this,arguments)})},{key:"getOrderSummaryElement",value:function(){}},{key:"extractCouponCodeElement",value:function(t){var e=t.querySelector(".i8os0m3");return e?e.textContent:""}},{key:"isCheckoutPage",value:function(t){return/^(?!.*\/checkout(?:s)?\/$)(?=.*\/checkout(?:s)?\/(?!$)(?!.*\/thank(?:s)?))(?!.*\/thank(?:_you)?|.*\/post_purchase|.*\/purchase\/thanks).*/.test(t)}}],r&&wn(e.prototype,r),Object.defineProperty(e,"prototype",{writable:!1}),t}();function _n(t){return _n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_n(t)}function xn(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(void 0,o=function(t,e){if("object"!==_n(t)||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,"string");if("object"!==_n(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(n.key),"symbol"===_n(o)?o:String(o)),n)}var o}function Sn(t,e){return Sn=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},Sn(t,e)}function Pn(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var r,n=Ln(t);if(e){var o=Ln(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return function(t,e){if(e&&("object"===_n(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,r)}}function Ln(t){return Ln=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},Ln(t)}var Nn=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Sn(t,e)}(o,t);var e,r,n=Pn(o);function o(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,o),n.apply(this,arguments)}return e=o,(r=[{key:"getExtractorName",value:function(){return x.SHOP_PAY_CHECKOUT}},{key:"getOrderSummaryElement",value:function(){return document.documentElement}}])&&xn(e.prototype,r),Object.defineProperty(e,"prototype",{writable:!1}),o}(On);function Cn(t){return Cn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Cn(t)}function Tn(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(void 0,o=function(t,e){if("object"!==Cn(t)||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,"string");if("object"!==Cn(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(n.key),"symbol"===Cn(o)?o:String(o)),n)}var o}function An(t,e){return An=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},An(t,e)}function jn(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var r,n=kn(t);if(e){var o=kn(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return function(t,e){if(e&&("object"===Cn(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,r)}}function kn(t){return kn=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},kn(t)}var In=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&An(t,e)}(o,t);var e,r,n=jn(o);function o(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,o),n.apply(this,arguments)}return e=o,(r=[{key:"getExtractorName",value:function(){return x.SHOPIFY_ENCODED}},{key:"getOrderSummaryElement",value:function(){return document.getElementById(P)||document.getElementById(L)}}])&&Tn(e.prototype,r),Object.defineProperty(e,"prototype",{writable:!1}),o}(On);function Rn(t){return Rn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Rn(t)}function Fn(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(void 0,o=function(t,e){if("object"!==Rn(t)||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,"string");if("object"!==Rn(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(n.key),"symbol"===Rn(o)?o:String(o)),n)}var o}function Dn(t,e){return Dn=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},Dn(t,e)}function Un(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var r,n=Gn(t);if(e){var o=Gn(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return function(t,e){if(e&&("object"===Rn(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,r)}}function Gn(t){return Gn=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},Gn(t)}var Mn=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Dn(t,e)}(o,t);var e,r,n=Un(o);function o(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,o),n.apply(this,arguments)}return e=o,(r=[{key:"getExtractorName",value:function(){return x.SHOPIFY_STANDARD}},{key:"getOrderSummaryElement",value:function(){return document.getElementById(N)}},{key:"extractCouponCodeElement",value:function(t){var e,r,n=null===(e=t.querySelector(".tag__button"))||void 0===e||null===(r=e.parentElement)||void 0===r?void 0:r.firstElementChild;return n?n.textContent.trim():""}}])&&Fn(e.prototype,r),Object.defineProperty(e,"prototype",{writable:!1}),o}(On);function Hn(t){return Hn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Hn(t)}function Bn(){/*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/facebook/regenerator/blob/main/LICENSE */Bn=function(){return t};var t={},e=Object.prototype,r=e.hasOwnProperty,n=Object.defineProperty||function(t,e,r){t[e]=r.value},o="function"==typeof Symbol?Symbol:{},i=o.iterator||"@@iterator",a=o.asyncIterator||"@@asyncIterator",u=o.toStringTag||"@@toStringTag";function c(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{c({},"")}catch(t){c=function(t,e,r){return t[e]=r}}function l(t,e,r,o){var i=e&&e.prototype instanceof h?e:h,a=Object.create(i.prototype),u=new S(o||[]);return n(a,"_invoke",{value:w(t,r,u)}),a}function s(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}t.wrap=l;var f={};function h(){}function p(){}function d(){}var v={};c(v,i,(function(){return this}));var y=Object.getPrototypeOf,m=y&&y(y(P([])));m&&m!==e&&r.call(m,i)&&(v=m);var g=d.prototype=h.prototype=Object.create(v);function b(t){["next","throw","return"].forEach((function(e){c(t,e,(function(t){return this._invoke(e,t)}))}))}function E(t,e){function o(n,i,a,u){var c=s(t[n],t,i);if("throw"!==c.type){var l=c.arg,f=l.value;return f&&"object"==Hn(f)&&r.call(f,"__await")?e.resolve(f.__await).then((function(t){o("next",t,a,u)}),(function(t){o("throw",t,a,u)})):e.resolve(f).then((function(t){l.value=t,a(l)}),(function(t){return o("throw",t,a,u)}))}u(c.arg)}var i;n(this,"_invoke",{value:function(t,r){function n(){return new e((function(e,n){o(t,r,e,n)}))}return i=i?i.then(n,n):n()}})}function w(t,e,r){var n="suspendedStart";return function(o,i){if("executing"===n)throw new Error("Generator is already running");if("completed"===n){if("throw"===o)throw i;return{value:void 0,done:!0}}for(r.method=o,r.arg=i;;){var a=r.delegate;if(a){var u=O(a,r);if(u){if(u===f)continue;return u}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if("suspendedStart"===n)throw n="completed",r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);n="executing";var c=s(t,e,r);if("normal"===c.type){if(n=r.done?"completed":"suspendedYield",c.arg===f)continue;return{value:c.arg,done:r.done}}"throw"===c.type&&(n="completed",r.method="throw",r.arg=c.arg)}}}function O(t,e){var r=e.method,n=t.iterator[r];if(void 0===n)return e.delegate=null,"throw"===r&&t.iterator.return&&(e.method="return",e.arg=void 0,O(t,e),"throw"===e.method)||"return"!==r&&(e.method="throw",e.arg=new TypeError("The iterator does not provide a '"+r+"' method")),f;var o=s(n,t.iterator,e.arg);if("throw"===o.type)return e.method="throw",e.arg=o.arg,e.delegate=null,f;var i=o.arg;return i?i.done?(e[t.resultName]=i.value,e.next=t.nextLoc,"return"!==e.method&&(e.method="next",e.arg=void 0),e.delegate=null,f):i:(e.method="throw",e.arg=new TypeError("iterator result is not an object"),e.delegate=null,f)}function _(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function x(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function S(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(_,this),this.reset(!0)}function P(t){if(t){var e=t[i];if(e)return e.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var n=-1,o=function e(){for(;++n<t.length;)if(r.call(t,n))return e.value=t[n],e.done=!1,e;return e.value=void 0,e.done=!0,e};return o.next=o}}return{next:L}}function L(){return{value:void 0,done:!0}}return p.prototype=d,n(g,"constructor",{value:d,configurable:!0}),n(d,"constructor",{value:p,configurable:!0}),p.displayName=c(d,u,"GeneratorFunction"),t.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===p||"GeneratorFunction"===(e.displayName||e.name))},t.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,d):(t.__proto__=d,c(t,u,"GeneratorFunction")),t.prototype=Object.create(g),t},t.awrap=function(t){return{__await:t}},b(E.prototype),c(E.prototype,a,(function(){return this})),t.AsyncIterator=E,t.async=function(e,r,n,o,i){void 0===i&&(i=Promise);var a=new E(l(e,r,n,o),i);return t.isGeneratorFunction(r)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},b(g),c(g,u,"Generator"),c(g,i,(function(){return this})),c(g,"toString",(function(){return"[object Generator]"})),t.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function t(){for(;r.length;){var n=r.pop();if(n in e)return t.value=n,t.done=!1,t}return t.done=!0,t}},t.values=P,S.prototype={constructor:S,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(x),!t)for(var e in this)"t"===e.charAt(0)&&r.call(this,e)&&!isNaN(+e.slice(1))&&(this[e]=void 0)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var e=this;function n(r,n){return a.type="throw",a.arg=t,e.next=r,n&&(e.method="next",e.arg=void 0),!!n}for(var o=this.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],a=i.completion;if("root"===i.tryLoc)return n("end");if(i.tryLoc<=this.prev){var u=r.call(i,"catchLoc"),c=r.call(i,"finallyLoc");if(u&&c){if(this.prev<i.catchLoc)return n(i.catchLoc,!0);if(this.prev<i.finallyLoc)return n(i.finallyLoc)}else if(u){if(this.prev<i.catchLoc)return n(i.catchLoc,!0)}else{if(!c)throw new Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return n(i.finallyLoc)}}}},abrupt:function(t,e){for(var n=this.tryEntries.length-1;n>=0;--n){var o=this.tryEntries[n];if(o.tryLoc<=this.prev&&r.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=t,a.arg=e,i?(this.method="next",this.next=i.finallyLoc,f):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),f},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),x(r),f}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var o=n.arg;x(r)}return o}}throw new Error("illegal catch attempt")},delegateYield:function(t,e,r){return this.delegate={iterator:P(t),resultName:e,nextLoc:r},"next"===this.method&&(this.arg=void 0),f}},t}function qn(t,e,r,n,o,i,a){try{var u=t[i](a),c=u.value}catch(t){return void r(t)}u.done?e(c):Promise.resolve(c).then(n,o)}function Yn(){return Wn.apply(this,arguments)}function Wn(){return(Wn=function(t){return function(){var e=this,r=arguments;return new Promise((function(n,o){var i=t.apply(e,r);function a(t){qn(i,n,o,a,u,"next",t)}function u(t){qn(i,n,o,a,u,"throw",t)}a(void 0)}))}}(Bn().mark((function t(){var e;return Bn().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e=null,e=zo()?new Mn:Jo()?new In:$o()?new Nn:new On,t.next=4,e.genExtract();case 4:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function Kn(t){return Kn="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Kn(t)}function Vn(){/*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/facebook/regenerator/blob/main/LICENSE */Vn=function(){return t};var t={},e=Object.prototype,r=e.hasOwnProperty,n=Object.defineProperty||function(t,e,r){t[e]=r.value},o="function"==typeof Symbol?Symbol:{},i=o.iterator||"@@iterator",a=o.asyncIterator||"@@asyncIterator",u=o.toStringTag||"@@toStringTag";function c(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{c({},"")}catch(t){c=function(t,e,r){return t[e]=r}}function l(t,e,r,o){var i=e&&e.prototype instanceof h?e:h,a=Object.create(i.prototype),u=new S(o||[]);return n(a,"_invoke",{value:w(t,r,u)}),a}function s(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}t.wrap=l;var f={};function h(){}function p(){}function d(){}var v={};c(v,i,(function(){return this}));var y=Object.getPrototypeOf,m=y&&y(y(P([])));m&&m!==e&&r.call(m,i)&&(v=m);var g=d.prototype=h.prototype=Object.create(v);function b(t){["next","throw","return"].forEach((function(e){c(t,e,(function(t){return this._invoke(e,t)}))}))}function E(t,e){function o(n,i,a,u){var c=s(t[n],t,i);if("throw"!==c.type){var l=c.arg,f=l.value;return f&&"object"==Kn(f)&&r.call(f,"__await")?e.resolve(f.__await).then((function(t){o("next",t,a,u)}),(function(t){o("throw",t,a,u)})):e.resolve(f).then((function(t){l.value=t,a(l)}),(function(t){return o("throw",t,a,u)}))}u(c.arg)}var i;n(this,"_invoke",{value:function(t,r){function n(){return new e((function(e,n){o(t,r,e,n)}))}return i=i?i.then(n,n):n()}})}function w(t,e,r){var n="suspendedStart";return function(o,i){if("executing"===n)throw new Error("Generator is already running");if("completed"===n){if("throw"===o)throw i;return{value:void 0,done:!0}}for(r.method=o,r.arg=i;;){var a=r.delegate;if(a){var u=O(a,r);if(u){if(u===f)continue;return u}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if("suspendedStart"===n)throw n="completed",r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);n="executing";var c=s(t,e,r);if("normal"===c.type){if(n=r.done?"completed":"suspendedYield",c.arg===f)continue;return{value:c.arg,done:r.done}}"throw"===c.type&&(n="completed",r.method="throw",r.arg=c.arg)}}}function O(t,e){var r=e.method,n=t.iterator[r];if(void 0===n)return e.delegate=null,"throw"===r&&t.iterator.return&&(e.method="return",e.arg=void 0,O(t,e),"throw"===e.method)||"return"!==r&&(e.method="throw",e.arg=new TypeError("The iterator does not provide a '"+r+"' method")),f;var o=s(n,t.iterator,e.arg);if("throw"===o.type)return e.method="throw",e.arg=o.arg,e.delegate=null,f;var i=o.arg;return i?i.done?(e[t.resultName]=i.value,e.next=t.nextLoc,"return"!==e.method&&(e.method="next",e.arg=void 0),e.delegate=null,f):i:(e.method="throw",e.arg=new TypeError("iterator result is not an object"),e.delegate=null,f)}function _(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function x(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function S(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(_,this),this.reset(!0)}function P(t){if(t){var e=t[i];if(e)return e.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var n=-1,o=function e(){for(;++n<t.length;)if(r.call(t,n))return e.value=t[n],e.done=!1,e;return e.value=void 0,e.done=!0,e};return o.next=o}}return{next:L}}function L(){return{value:void 0,done:!0}}return p.prototype=d,n(g,"constructor",{value:d,configurable:!0}),n(d,"constructor",{value:p,configurable:!0}),p.displayName=c(d,u,"GeneratorFunction"),t.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===p||"GeneratorFunction"===(e.displayName||e.name))},t.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,d):(t.__proto__=d,c(t,u,"GeneratorFunction")),t.prototype=Object.create(g),t},t.awrap=function(t){return{__await:t}},b(E.prototype),c(E.prototype,a,(function(){return this})),t.AsyncIterator=E,t.async=function(e,r,n,o,i){void 0===i&&(i=Promise);var a=new E(l(e,r,n,o),i);return t.isGeneratorFunction(r)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},b(g),c(g,u,"Generator"),c(g,i,(function(){return this})),c(g,"toString",(function(){return"[object Generator]"})),t.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function t(){for(;r.length;){var n=r.pop();if(n in e)return t.value=n,t.done=!1,t}return t.done=!0,t}},t.values=P,S.prototype={constructor:S,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(x),!t)for(var e in this)"t"===e.charAt(0)&&r.call(this,e)&&!isNaN(+e.slice(1))&&(this[e]=void 0)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var e=this;function n(r,n){return a.type="throw",a.arg=t,e.next=r,n&&(e.method="next",e.arg=void 0),!!n}for(var o=this.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],a=i.completion;if("root"===i.tryLoc)return n("end");if(i.tryLoc<=this.prev){var u=r.call(i,"catchLoc"),c=r.call(i,"finallyLoc");if(u&&c){if(this.prev<i.catchLoc)return n(i.catchLoc,!0);if(this.prev<i.finallyLoc)return n(i.finallyLoc)}else if(u){if(this.prev<i.catchLoc)return n(i.catchLoc,!0)}else{if(!c)throw new Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return n(i.finallyLoc)}}}},abrupt:function(t,e){for(var n=this.tryEntries.length-1;n>=0;--n){var o=this.tryEntries[n];if(o.tryLoc<=this.prev&&r.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=t,a.arg=e,i?(this.method="next",this.next=i.finallyLoc,f):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),f},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),x(r),f}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var o=n.arg;x(r)}return o}}throw new Error("illegal catch attempt")},delegateYield:function(t,e,r){return this.delegate={iterator:P(t),resultName:e,nextLoc:r},"next"===this.method&&(this.arg=void 0),f}},t}function Xn(t,e){var r="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!r){if(Array.isArray(t)||(r=function(t,e){if(t){if("string"==typeof t)return Qn(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?Qn(t,e):void 0}}(t))||e&&t&&"number"==typeof t.length){r&&(t=r);var n=0,o=function(){};return{s:o,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(t){throw t},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,u=!1;return{s:function(){r=r.call(t)},n:function(){var t=r.next();return a=t.done,t},e:function(t){u=!0,i=t},f:function(){try{a||null==r.return||r.return()}finally{if(u)throw i}}}}function Qn(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function zn(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}function Jn(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?zn(Object(r),!0).forEach((function(e){$n(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):zn(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}function $n(t,e,r){return(e=function(t){var e=function(t,e){if("object"!==Kn(t)||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,"string");if("object"!==Kn(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"===Kn(e)?e:String(e)}(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function Zn(t,e,r,n,o,i,a){try{var u=t[i](a),c=u.value}catch(t){return void r(t)}u.done?e(c):Promise.resolve(c).then(n,o)}function to(t){return function(){var e=this,r=arguments;return new Promise((function(n,o){var i=t.apply(e,r);function a(t){Zn(i,n,o,a,u,"next",t)}function u(t){Zn(i,n,o,a,u,"throw",t)}a(void 0)}))}}function eo(t){return ro.apply(this,arguments)}function ro(){return(ro=to(Vn().mark((function t(e){var r,n,o,i;return Vn().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(Z("Starting Coupon Validation task... "),e&&0!==(null==e?void 0:e.length)){t.next=3;break}return t.abrupt("return");case 3:if(n=io(e),0!==(null===(r=n)||void 0===r?void 0:r.length)){t.next=7;break}return Z("couponValidator No coupon associated urls match the current page url. Stopping validation"),t.abrupt("return");case 7:n=ao(n),o=Xn(n);try{for(o.s();!(i=o.n()).done;)uo(i.value)}catch(t){o.e(t)}finally{o.f()}case 10:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function no(t){return oo.apply(this,arguments)}function oo(){return(oo=to(Vn().mark((function t(e){var r,n;return Vn().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(Z("Starting CheckCouponExistance task... "),null!=e&&e.length){t.next=3;break}return t.abrupt("return");case 3:r=Xn(e);try{for(r.s();!(n=r.n()).done;)uo({coupon_code:n.value},!0)}catch(t){r.e(t)}finally{r.f()}case 5:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function io(t){var e=window.location.href;return t.filter((function(t){return Oe(null==t?void 0:t.crawled_url)===Oe(e)}))}function ao(t){return t.map((function(t){return Jn(Jn({},t),{},{extraction_text:(e=t.extraction_text,r=t.coupon_code,o=new RegExp("(?:.{0,2}\\b".concat(r,"\\b)"),"i"),i=null==e?void 0:e.match(o),a=null!==(n=null==i?void 0:i[0])&&void 0!==n?n:"",a.trim())});var e,r,n,o,i,a}))}function uo(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=function(t){var e,r,n,o=null==t||null===(e=t.coupon_code)||void 0===e?void 0:e.toLowerCase(),i=null==t||null===(r=t.extraction_text)||void 0===r?void 0:r.toLowerCase(),a=!1,u=!1,c=!1,l=(n=null==t?void 0:t.css_class)&&""!==n.trim()?n.replace(/\s+/g," ").trim().split(" ").reduce((function(t,e){return t+".".concat(e)}),""):"";if(l){var s=document.querySelectorAll(l);if((null==s?void 0:s.length)>0&&(c=!0,a=Array.from(s).some((function(t){return so(t,o)})),u=Array.from(s).some((function(t){return so(t,i)}))),a)return{couponFound:a,extractionTextFound:u,cssClassSelectorIsValid:c}}if(document.body){var f=document.body;a=so(f,o),i&&(u=so(f,i))}return{couponFound:a,extractionTextFound:u,cssClassSelectorIsValid:c}}(t);if(null!=r&&r.couponFound)return e&&lo(t),void Z("Coupon found in initial search. Stopping search");var n=function(t,e){var r=new MutationObserver((function(n){var o,i=Xn(n);try{for(i.s();!(o=i.n()).done;){var a,u=co(o.value,null==t||null===(a=t.coupon_code)||void 0===a?void 0:a.toLowerCase());if(u&&e)lo(t),r.disconnect();else if(u)return void r.disconnect()}}catch(t){i.e(t)}finally{i.f()}}));return document.body&&r.observe(document.body,{childList:!0,subtree:!0}),r}(t,e),o=function(t,e,r,n){return function(o){if(t.disconnect(),!n){var i=["Coupon code not found.",r.extractionTextFound?"":"Extraction text not found.",r.cssClassSelectorIsValid?"":"Css class is empty or invalid.",o?"":"Page navigation occurred before timeout expiration."].filter(Boolean).join(" ");!function(t){Z("Invalid coupon code found. Sending task result"),I({result:y.INFO,event:m.COUPON_VALIDATION_CHECK,description:"Coupon validation result - coupon is invalid",url:window.location.href,metadata:JSON.stringify(t)})}([{couponCode:e.coupon_code,crawledUrl:e.crawled_url,reason:i}])}}}(n,t,r,e),i=function(){clearTimeout(a),o(!1)},a=setTimeout((function(){window.removeEventListener("beforeunload",i),o(!0)}),3e4);window.addEventListener("beforeunload",i,{once:!0}),n.takeRecords().forEach((function(e){co(e,t.coupon_code.toLowerCase())&&(clearTimeout(a),window.removeEventListener("beforeunload",i),n.disconnect())}))}function co(t,e){var r,n=Xn(t.addedNodes);try{for(n.s();!(r=n.n()).done;){var o=r.value;if(o instanceof Node&&so(o,e))return!0}}catch(t){n.e(t)}finally{n.f()}return!1}function lo(t){Z("Better offer than email capture found on adrvertiser website. Sending task result");var e="Coupon code '".concat(t.coupon_code,"' found"),r=[{couponCode:t.coupon_code,reason:e}];I({result:y.INFO,event:m.COUPON_EXISTANCE_CHECK,description:"Better offer than email capture found on adrvertiser website",url:window.location.href,metadata:JSON.stringify(r)})}function so(t,e){if(!e)return!1;var r;if(document.createTreeWalker(t,NodeFilter.SHOW_TEXT,(r=e,{acceptNode:function(t){return t.nodeType===Node.TEXT_NODE&&t.textContent&&t.textContent.toLowerCase().includes(r)?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}}),!1).nextNode())return!0;if(t instanceof HTMLElement&&t.shadowRoot)try{if(so(t.shadowRoot,e))return!0}catch(t){Z("Shadow DOM is inaccessible")}if(t instanceof HTMLIFrameElement&&t.contentDocument&&t.contentDocument.body)try{if(so(t.contentDocument.body,e))return!0}catch(t){Z("iFrame is inaccessible due to cross origin policy")}return!1}function fo(t){return fo="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},fo(t)}function ho(t,e){var r="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!r){if(Array.isArray(t)||(r=yo(t))||e&&t&&"number"==typeof t.length){r&&(t=r);var n=0,o=function(){};return{s:o,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(t){throw t},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,u=!1;return{s:function(){r=r.call(t)},n:function(){var t=r.next();return a=t.done,t},e:function(t){u=!0,i=t},f:function(){try{a||null==r.return||r.return()}finally{if(u)throw i}}}}function po(){/*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/facebook/regenerator/blob/main/LICENSE */po=function(){return t};var t={},e=Object.prototype,r=e.hasOwnProperty,n=Object.defineProperty||function(t,e,r){t[e]=r.value},o="function"==typeof Symbol?Symbol:{},i=o.iterator||"@@iterator",a=o.asyncIterator||"@@asyncIterator",u=o.toStringTag||"@@toStringTag";function c(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{c({},"")}catch(t){c=function(t,e,r){return t[e]=r}}function l(t,e,r,o){var i=e&&e.prototype instanceof h?e:h,a=Object.create(i.prototype),u=new S(o||[]);return n(a,"_invoke",{value:w(t,r,u)}),a}function s(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}t.wrap=l;var f={};function h(){}function p(){}function d(){}var v={};c(v,i,(function(){return this}));var y=Object.getPrototypeOf,m=y&&y(y(P([])));m&&m!==e&&r.call(m,i)&&(v=m);var g=d.prototype=h.prototype=Object.create(v);function b(t){["next","throw","return"].forEach((function(e){c(t,e,(function(t){return this._invoke(e,t)}))}))}function E(t,e){function o(n,i,a,u){var c=s(t[n],t,i);if("throw"!==c.type){var l=c.arg,f=l.value;return f&&"object"==fo(f)&&r.call(f,"__await")?e.resolve(f.__await).then((function(t){o("next",t,a,u)}),(function(t){o("throw",t,a,u)})):e.resolve(f).then((function(t){l.value=t,a(l)}),(function(t){return o("throw",t,a,u)}))}u(c.arg)}var i;n(this,"_invoke",{value:function(t,r){function n(){return new e((function(e,n){o(t,r,e,n)}))}return i=i?i.then(n,n):n()}})}function w(t,e,r){var n="suspendedStart";return function(o,i){if("executing"===n)throw new Error("Generator is already running");if("completed"===n){if("throw"===o)throw i;return{value:void 0,done:!0}}for(r.method=o,r.arg=i;;){var a=r.delegate;if(a){var u=O(a,r);if(u){if(u===f)continue;return u}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if("suspendedStart"===n)throw n="completed",r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);n="executing";var c=s(t,e,r);if("normal"===c.type){if(n=r.done?"completed":"suspendedYield",c.arg===f)continue;return{value:c.arg,done:r.done}}"throw"===c.type&&(n="completed",r.method="throw",r.arg=c.arg)}}}function O(t,e){var r=e.method,n=t.iterator[r];if(void 0===n)return e.delegate=null,"throw"===r&&t.iterator.return&&(e.method="return",e.arg=void 0,O(t,e),"throw"===e.method)||"return"!==r&&(e.method="throw",e.arg=new TypeError("The iterator does not provide a '"+r+"' method")),f;var o=s(n,t.iterator,e.arg);if("throw"===o.type)return e.method="throw",e.arg=o.arg,e.delegate=null,f;var i=o.arg;return i?i.done?(e[t.resultName]=i.value,e.next=t.nextLoc,"return"!==e.method&&(e.method="next",e.arg=void 0),e.delegate=null,f):i:(e.method="throw",e.arg=new TypeError("iterator result is not an object"),e.delegate=null,f)}function _(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function x(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function S(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(_,this),this.reset(!0)}function P(t){if(t){var e=t[i];if(e)return e.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var n=-1,o=function e(){for(;++n<t.length;)if(r.call(t,n))return e.value=t[n],e.done=!1,e;return e.value=void 0,e.done=!0,e};return o.next=o}}return{next:L}}function L(){return{value:void 0,done:!0}}return p.prototype=d,n(g,"constructor",{value:d,configurable:!0}),n(d,"constructor",{value:p,configurable:!0}),p.displayName=c(d,u,"GeneratorFunction"),t.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===p||"GeneratorFunction"===(e.displayName||e.name))},t.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,d):(t.__proto__=d,c(t,u,"GeneratorFunction")),t.prototype=Object.create(g),t},t.awrap=function(t){return{__await:t}},b(E.prototype),c(E.prototype,a,(function(){return this})),t.AsyncIterator=E,t.async=function(e,r,n,o,i){void 0===i&&(i=Promise);var a=new E(l(e,r,n,o),i);return t.isGeneratorFunction(r)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},b(g),c(g,u,"Generator"),c(g,i,(function(){return this})),c(g,"toString",(function(){return"[object Generator]"})),t.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function t(){for(;r.length;){var n=r.pop();if(n in e)return t.value=n,t.done=!1,t}return t.done=!0,t}},t.values=P,S.prototype={constructor:S,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(x),!t)for(var e in this)"t"===e.charAt(0)&&r.call(this,e)&&!isNaN(+e.slice(1))&&(this[e]=void 0)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var e=this;function n(r,n){return a.type="throw",a.arg=t,e.next=r,n&&(e.method="next",e.arg=void 0),!!n}for(var o=this.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],a=i.completion;if("root"===i.tryLoc)return n("end");if(i.tryLoc<=this.prev){var u=r.call(i,"catchLoc"),c=r.call(i,"finallyLoc");if(u&&c){if(this.prev<i.catchLoc)return n(i.catchLoc,!0);if(this.prev<i.finallyLoc)return n(i.finallyLoc)}else if(u){if(this.prev<i.catchLoc)return n(i.catchLoc,!0)}else{if(!c)throw new Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return n(i.finallyLoc)}}}},abrupt:function(t,e){for(var n=this.tryEntries.length-1;n>=0;--n){var o=this.tryEntries[n];if(o.tryLoc<=this.prev&&r.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=t,a.arg=e,i?(this.method="next",this.next=i.finallyLoc,f):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),f},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),x(r),f}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var o=n.arg;x(r)}return o}}throw new Error("illegal catch attempt")},delegateYield:function(t,e,r){return this.delegate={iterator:P(t),resultName:e,nextLoc:r},"next"===this.method&&(this.arg=void 0),f}},t}function vo(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var r=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=r){var n,o,i,a,u=[],c=!0,l=!1;try{if(i=(r=r.call(t)).next,0===e){if(Object(r)!==r)return;c=!1}else for(;!(c=(n=i.call(r)).done)&&(u.push(n.value),u.length!==e);c=!0);}catch(t){l=!0,o=t}finally{try{if(!c&&null!=r.return&&(a=r.return(),Object(a)!==a))return}finally{if(l)throw o}}return u}}(t,e)||yo(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function yo(t,e){if(t){if("string"==typeof t)return mo(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?mo(t,e):void 0}}function mo(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function go(t,e,r,n,o,i,a){try{var u=t[i](a),c=u.value}catch(t){return void r(t)}u.done?e(c):Promise.resolve(c).then(n,o)}function bo(t){return function(){var e=this,r=arguments;return new Promise((function(n,o){var i=t.apply(e,r);function a(t){go(i,n,o,a,u,"next",t)}function u(t){go(i,n,o,a,u,"throw",t)}a(void 0)}))}}function Eo(){return(Eo=bo(po().mark((function t(){var e;return po().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,ct((function(t){return null!=i}));case 2:null!=(e=null==i?void 0:i.tasks)&&Object.entries(e).forEach((function(t){var e=vo(t,2);e[0],wo(e[1])}));case 4:case"end":return t.stop()}}),t)})))).apply(this,arguments)}function wo(t){return Oo.apply(this,arguments)}function Oo(){return(Oo=bo(po().mark((function t(r){var n,o,i;return po().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:n=ho(r),t.prev=1,i=po().mark((function t(){var r,n,i,a,u,l,s,f,h,p,d,v,m,g,b;return po().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:a=o.value,u=a.name,l=a.querySelector,s=a.log,f=a.time,h=a.browser_event_type,p=a.browser_event_signal_type,d=a.matched_text_in_clipboard,v=a.coupon_context,m=a.coupon_codes,g=a.auto_apply_instructions,b=null!=l?document.querySelector(l):null,Z("task",{name:u,querySelector:l,element:b,time:f,browser_event_type:h,browser_event_signal_type:p,matched_text_in_clipboard:d,coupon_context:v,coupon_codes:m,auto_apply_instructions:g}),t.t0=u,t.next=t.t0===e.CLICK?6:t.t0===e.HIDE?8:t.t0===e.WAIT_FOR_VISIBLE?10:t.t0===e.FOCUS?15:t.t0===e.SLEEP?17:t.t0===e.EXTRACT_OCP?20:t.t0===e.EXTRACT_CHECKOUT?22:t.t0===e.LISTEN_FOR_EVENT?24:t.t0===e.VALIDATE_COUPON?26:t.t0===e.COUPON_EXISTANCE_CHECK?28:30;break;case 6:return null===(r=b)||void 0===r||r.click(),t.abrupt("break",30);case 8:return null===(n=b)||void 0===n||n.remove(),t.abrupt("break",30);case 10:if(null!=b){t.next=14;break}return t.next=13,at(null!=l?l:"");case 13:b=t.sent;case 14:return t.abrupt("break",30);case 15:return null===(i=b)||void 0===i||i.focus(),t.abrupt("break",30);case 17:return t.next=19,ft(null!=f?f:500);case 19:return t.abrupt("break",30);case 20:return setTimeout(bo(po().mark((function t(){return po().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,he("extract-ocp-"+c()());case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t)}))),100),t.abrupt("break",30);case 22:return setTimeout(bo(po().mark((function t(){return po().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Yn();case 2:return t.abrupt("return",t.sent);case 3:case"end":return t.stop()}}),t)}))),100),t.abrupt("break",30);case 24:return mn(h,p,d,g),t.abrupt("break",30);case 26:return setTimeout(bo(po().mark((function t(){return po().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,eo(v);case 2:case"end":return t.stop()}}),t)}))),100),t.abrupt("break",30);case 28:return setTimeout(bo(po().mark((function t(){return po().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,no(m);case 2:case"end":return t.stop()}}),t)}))),100),t.abrupt("break",30);case 30:null!=b&&null!=s&&I({result:y.INFO,event:s,description:s,url:window.location.href});case 31:case"end":return t.stop()}}),t)})),n.s();case 4:if((o=n.n()).done){t.next=8;break}return t.delegateYield(i(),"t0",6);case 6:t.next=4;break;case 8:t.next=13;break;case 10:t.prev=10,t.t1=t.catch(1),n.e(t.t1);case 13:return t.prev=13,n.f(),t.finish(13);case 16:case"end":return t.stop()}}),t,null,[[1,10,13,16]])})))).apply(this,arguments)}function _o(t){return _o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_o(t)}function xo(t,e){var r="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!r){if(Array.isArray(t)||(r=function(t,e){if(t){if("string"==typeof t)return So(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?So(t,e):void 0}}(t))||e&&t&&"number"==typeof t.length){r&&(t=r);var n=0,o=function(){};return{s:o,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(t){throw t},f:o}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,a=!0,u=!1;return{s:function(){r=r.call(t)},n:function(){var t=r.next();return a=t.done,t},e:function(t){u=!0,i=t},f:function(){try{a||null==r.return||r.return()}finally{if(u)throw i}}}}function So(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function Po(){/*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/facebook/regenerator/blob/main/LICENSE */Po=function(){return t};var t={},e=Object.prototype,r=e.hasOwnProperty,n=Object.defineProperty||function(t,e,r){t[e]=r.value},o="function"==typeof Symbol?Symbol:{},i=o.iterator||"@@iterator",a=o.asyncIterator||"@@asyncIterator",u=o.toStringTag||"@@toStringTag";function c(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{c({},"")}catch(t){c=function(t,e,r){return t[e]=r}}function l(t,e,r,o){var i=e&&e.prototype instanceof h?e:h,a=Object.create(i.prototype),u=new S(o||[]);return n(a,"_invoke",{value:w(t,r,u)}),a}function s(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}t.wrap=l;var f={};function h(){}function p(){}function d(){}var v={};c(v,i,(function(){return this}));var y=Object.getPrototypeOf,m=y&&y(y(P([])));m&&m!==e&&r.call(m,i)&&(v=m);var g=d.prototype=h.prototype=Object.create(v);function b(t){["next","throw","return"].forEach((function(e){c(t,e,(function(t){return this._invoke(e,t)}))}))}function E(t,e){function o(n,i,a,u){var c=s(t[n],t,i);if("throw"!==c.type){var l=c.arg,f=l.value;return f&&"object"==_o(f)&&r.call(f,"__await")?e.resolve(f.__await).then((function(t){o("next",t,a,u)}),(function(t){o("throw",t,a,u)})):e.resolve(f).then((function(t){l.value=t,a(l)}),(function(t){return o("throw",t,a,u)}))}u(c.arg)}var i;n(this,"_invoke",{value:function(t,r){function n(){return new e((function(e,n){o(t,r,e,n)}))}return i=i?i.then(n,n):n()}})}function w(t,e,r){var n="suspendedStart";return function(o,i){if("executing"===n)throw new Error("Generator is already running");if("completed"===n){if("throw"===o)throw i;return{value:void 0,done:!0}}for(r.method=o,r.arg=i;;){var a=r.delegate;if(a){var u=O(a,r);if(u){if(u===f)continue;return u}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if("suspendedStart"===n)throw n="completed",r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);n="executing";var c=s(t,e,r);if("normal"===c.type){if(n=r.done?"completed":"suspendedYield",c.arg===f)continue;return{value:c.arg,done:r.done}}"throw"===c.type&&(n="completed",r.method="throw",r.arg=c.arg)}}}function O(t,e){var r=e.method,n=t.iterator[r];if(void 0===n)return e.delegate=null,"throw"===r&&t.iterator.return&&(e.method="return",e.arg=void 0,O(t,e),"throw"===e.method)||"return"!==r&&(e.method="throw",e.arg=new TypeError("The iterator does not provide a '"+r+"' method")),f;var o=s(n,t.iterator,e.arg);if("throw"===o.type)return e.method="throw",e.arg=o.arg,e.delegate=null,f;var i=o.arg;return i?i.done?(e[t.resultName]=i.value,e.next=t.nextLoc,"return"!==e.method&&(e.method="next",e.arg=void 0),e.delegate=null,f):i:(e.method="throw",e.arg=new TypeError("iterator result is not an object"),e.delegate=null,f)}function _(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function x(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function S(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(_,this),this.reset(!0)}function P(t){if(t){var e=t[i];if(e)return e.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var n=-1,o=function e(){for(;++n<t.length;)if(r.call(t,n))return e.value=t[n],e.done=!1,e;return e.value=void 0,e.done=!0,e};return o.next=o}}return{next:L}}function L(){return{value:void 0,done:!0}}return p.prototype=d,n(g,"constructor",{value:d,configurable:!0}),n(d,"constructor",{value:p,configurable:!0}),p.displayName=c(d,u,"GeneratorFunction"),t.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===p||"GeneratorFunction"===(e.displayName||e.name))},t.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,d):(t.__proto__=d,c(t,u,"GeneratorFunction")),t.prototype=Object.create(g),t},t.awrap=function(t){return{__await:t}},b(E.prototype),c(E.prototype,a,(function(){return this})),t.AsyncIterator=E,t.async=function(e,r,n,o,i){void 0===i&&(i=Promise);var a=new E(l(e,r,n,o),i);return t.isGeneratorFunction(r)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},b(g),c(g,u,"Generator"),c(g,i,(function(){return this})),c(g,"toString",(function(){return"[object Generator]"})),t.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function t(){for(;r.length;){var n=r.pop();if(n in e)return t.value=n,t.done=!1,t}return t.done=!0,t}},t.values=P,S.prototype={constructor:S,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(x),!t)for(var e in this)"t"===e.charAt(0)&&r.call(this,e)&&!isNaN(+e.slice(1))&&(this[e]=void 0)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var e=this;function n(r,n){return a.type="throw",a.arg=t,e.next=r,n&&(e.method="next",e.arg=void 0),!!n}for(var o=this.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],a=i.completion;if("root"===i.tryLoc)return n("end");if(i.tryLoc<=this.prev){var u=r.call(i,"catchLoc"),c=r.call(i,"finallyLoc");if(u&&c){if(this.prev<i.catchLoc)return n(i.catchLoc,!0);if(this.prev<i.finallyLoc)return n(i.finallyLoc)}else if(u){if(this.prev<i.catchLoc)return n(i.catchLoc,!0)}else{if(!c)throw new Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return n(i.finallyLoc)}}}},abrupt:function(t,e){for(var n=this.tryEntries.length-1;n>=0;--n){var o=this.tryEntries[n];if(o.tryLoc<=this.prev&&r.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=t,a.arg=e,i?(this.method="next",this.next=i.finallyLoc,f):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),f},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),x(r),f}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var o=n.arg;x(r)}return o}}throw new Error("illegal catch attempt")},delegateYield:function(t,e,r){return this.delegate={iterator:P(t),resultName:e,nextLoc:r},"next"===this.method&&(this.arg=void 0),f}},t}function Lo(t,e,r,n,o,i,a){try{var u=t[i](a),c=u.value}catch(t){return void r(t)}u.done?e(c):Promise.resolve(c).then(n,o)}function No(t){return function(){var e=this,r=arguments;return new Promise((function(n,o){var i=t.apply(e,r);function a(t){Lo(i,n,o,a,u,"next",t)}function u(t){Lo(i,n,o,a,u,"throw",t)}a(void 0)}))}}function Co(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,Io(n.key),n)}}function To(t,e){return To=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},To(t,e)}function Ao(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var r,n=ko(t);if(e){var o=ko(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return function(t,e){if(e&&("object"===_o(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return jo(t)}(this,r)}}function jo(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function ko(t){return ko=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},ko(t)}function Io(t){var e=function(t,e){if("object"!==_o(t)||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,"string");if("object"!==_o(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"===_o(e)?e:String(e)}var Ro=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&To(t,e)}(h,t);var e,r,n,o,a,u,c=Ao(h);function h(){var t,e,r,n,o;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,h),r=jo(e=c.call(this)),o=!1,(n=Io(n="isJQueryEnabled"))in r?Object.defineProperty(r,n,{value:o,enumerable:!0,configurable:!0,writable:!0}):r[n]=o;var a=null==i||null===(t=i.autofill)||void 0===t?void 0:t.instructionBasedAutoApply;if(null==a)throw Error("instructionBasedAutoApply cannot be null to create PromoExtensionPromoCodeAutofillInstructionBasedExecutor ");e.config=a;try{window.jQuery&&(e.isJQueryEnabled=!0)}catch(t){Z("Can't find JQuery")}return e}return e=h,r=[{key:"getExecutorName",value:function(){return x.INSTRUCTION_BASED}},{key:"genExecuteActionsBeforeAutofill",value:(u=No(Po().mark((function t(){return Po().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,wo(this.config.actionsBeforeAutofill);case 2:case"end":return t.stop()}}),t,this)}))),function(){return u.apply(this,arguments)})},{key:"genExecuteActionsAfterAutofill",value:(a=No(Po().mark((function t(){return Po().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:case"end":return t.stop()}}),t)}))),function(){return a.apply(this,arguments)})},{key:"getFirstPromoCodeInput",value:function(){var t=document.querySelector(this.config.promoInputQuery);return t instanceof HTMLInputElement?t:null}},{key:"getApplyButton",value:function(t){var e,r;return null!==(e=document.querySelector(this.config.applyButtonQuery))&&void 0!==e?e:null===(r=t.form)||void 0===r?void 0:r.querySelector("button")}},{key:"fillInPromoCode",value:function(t,e){if(t.focus(),t.click(),window.React||document.querySelector("[data-reactroot], [data-reactid]")){var r,n=null===(r=Object.getOwnPropertyDescriptor(window.HTMLInputElement.prototype,"value"))||void 0===r?void 0:r.set;null==n||n.call(t,e)}else t.value=e;t.dispatchEvent(new Event("input",{bubbles:!0})),t.dispatchEvent(new Event("change",{bubbles:!0}))}},{key:"genObserveApplyPromoCodeResult",value:(o=No(Po().mark((function t(e){var r=this;return Po().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",new Promise((function(t,n){Z("Starts to observe apply promo code");var o=!1,i=new MutationObserver((function(n){n.forEach((function(n){if(!o)return r.isSuccessElementExist(r.config.successElementQuery.replace("XXX",e))||r.isErrorElementExist(r.config.errorElementQuery.replace("XXX",e))?(o=!0,i.disconnect(),void t()):void 0}))}));window.setTimeout((function(){o||(r.sendPromoExtensionPromoCodeAutofillResultForExecutor({result:O.FAIL,event:_.OBSERVE_AUTOFILL_RESULT_TIMEOUT,description:"Unknown"}),i.disconnect(),t())}),S),i.observe(document,{childList:!0,subtree:!0})})));case 1:case"end":return t.stop()}}),t)}))),function(t){return o.apply(this,arguments)})},{key:"genHandlePromoCodeAutoFillRequest",value:(n=No(Po().mark((function t(e){var r,n,o,i,a;return Po().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(Z(e,"Promo code autofill starts"),f&&!l&&!s){t.next=4;break}return Z(e,"Promo code autofill ends",{allowPerformAutofillAction:f,isPromoCodeAutofilling:l,promoCodeAutofillExecuted:s}),t.abrupt("return");case 4:return p(!0),t.next=7,this.genExecuteActionsBeforeAutofill();case 7:if(null!=(r=this.getFirstPromoCodeInput())){t.next=12;break}return Z(e,"Cannot find the input"),p(!1),t.abrupt("return");case 12:n=xo(this.config.promoCodes),t.prev=13,n.s();case 15:if((o=n.n()).done){t.next=33;break}return i=o.value,t.next=19,ft(500);case 19:return this.fillInPromoCode(r,i),Z(e,"Fill in ".concat(i),r),t.next=23,ft(500);case 23:if(null!=(a=this.getApplyButton(r))){t.next=28;break}return Z(e,"Cannot find the apply button"),p(!1),t.abrupt("return");case 28:return null==a||a.click(),t.next=31,this.genObserveApplyPromoCodeResult(i);case 31:t.next=15;break;case 33:t.next=38;break;case 35:t.prev=35,t.t0=t.catch(13),n.e(t.t0);case 38:return t.prev=38,n.f(),t.finish(38);case 41:d(!0),p(!1);case 43:case"end":return t.stop()}}),t,this,[[13,35,38,41]])}))),function(t){return n.apply(this,arguments)})},{key:"isSuccessElementExist",value:function(t){var e=!1;if(this.isJQueryEnabled&&t.includes(j)){var r=t.split(j)[1];e=$(":contains("+r+")").length>0}else e=null!=document.querySelector(t);return!!e&&(this.sendPromoExtensionPromoCodeAutofillResultForExecutor({result:O.SUCCESS}),!0)}},{key:"isErrorElementExist",value:function(t){var e,r=!1,n=null;if(this.isJQueryEnabled&&t.includes(j)){var o=t.split(j)[1];r=$(":contains("+o+")").length>0,n=o}else{var i=document.querySelector(t);r=null!=i,null!=i&&(n=i.innerText)}return!!r&&(this.sendPromoExtensionPromoCodeAutofillResultForExecutor({result:O.FAIL,event:_.HAS_PROMO_CODE_ERROR_ELEMENT,description:null!==(e=n)&&void 0!==e?e:"unknown"}),!0)}}],r&&Co(e.prototype,r),Object.defineProperty(e,"prototype",{writable:!1}),h}(Dt);function Fo(t){return Fo="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Fo(t)}function Do(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function Uo(){/*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/facebook/regenerator/blob/main/LICENSE */Uo=function(){return t};var t={},e=Object.prototype,r=e.hasOwnProperty,n=Object.defineProperty||function(t,e,r){t[e]=r.value},o="function"==typeof Symbol?Symbol:{},i=o.iterator||"@@iterator",a=o.asyncIterator||"@@asyncIterator",u=o.toStringTag||"@@toStringTag";function c(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{c({},"")}catch(t){c=function(t,e,r){return t[e]=r}}function l(t,e,r,o){var i=e&&e.prototype instanceof h?e:h,a=Object.create(i.prototype),u=new S(o||[]);return n(a,"_invoke",{value:w(t,r,u)}),a}function s(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}t.wrap=l;var f={};function h(){}function p(){}function d(){}var v={};c(v,i,(function(){return this}));var y=Object.getPrototypeOf,m=y&&y(y(P([])));m&&m!==e&&r.call(m,i)&&(v=m);var g=d.prototype=h.prototype=Object.create(v);function b(t){["next","throw","return"].forEach((function(e){c(t,e,(function(t){return this._invoke(e,t)}))}))}function E(t,e){function o(n,i,a,u){var c=s(t[n],t,i);if("throw"!==c.type){var l=c.arg,f=l.value;return f&&"object"==Fo(f)&&r.call(f,"__await")?e.resolve(f.__await).then((function(t){o("next",t,a,u)}),(function(t){o("throw",t,a,u)})):e.resolve(f).then((function(t){l.value=t,a(l)}),(function(t){return o("throw",t,a,u)}))}u(c.arg)}var i;n(this,"_invoke",{value:function(t,r){function n(){return new e((function(e,n){o(t,r,e,n)}))}return i=i?i.then(n,n):n()}})}function w(t,e,r){var n="suspendedStart";return function(o,i){if("executing"===n)throw new Error("Generator is already running");if("completed"===n){if("throw"===o)throw i;return{value:void 0,done:!0}}for(r.method=o,r.arg=i;;){var a=r.delegate;if(a){var u=O(a,r);if(u){if(u===f)continue;return u}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if("suspendedStart"===n)throw n="completed",r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);n="executing";var c=s(t,e,r);if("normal"===c.type){if(n=r.done?"completed":"suspendedYield",c.arg===f)continue;return{value:c.arg,done:r.done}}"throw"===c.type&&(n="completed",r.method="throw",r.arg=c.arg)}}}function O(t,e){var r=e.method,n=t.iterator[r];if(void 0===n)return e.delegate=null,"throw"===r&&t.iterator.return&&(e.method="return",e.arg=void 0,O(t,e),"throw"===e.method)||"return"!==r&&(e.method="throw",e.arg=new TypeError("The iterator does not provide a '"+r+"' method")),f;var o=s(n,t.iterator,e.arg);if("throw"===o.type)return e.method="throw",e.arg=o.arg,e.delegate=null,f;var i=o.arg;return i?i.done?(e[t.resultName]=i.value,e.next=t.nextLoc,"return"!==e.method&&(e.method="next",e.arg=void 0),e.delegate=null,f):i:(e.method="throw",e.arg=new TypeError("iterator result is not an object"),e.delegate=null,f)}function _(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function x(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function S(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(_,this),this.reset(!0)}function P(t){if(t){var e=t[i];if(e)return e.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var n=-1,o=function e(){for(;++n<t.length;)if(r.call(t,n))return e.value=t[n],e.done=!1,e;return e.value=void 0,e.done=!0,e};return o.next=o}}return{next:L}}function L(){return{value:void 0,done:!0}}return p.prototype=d,n(g,"constructor",{value:d,configurable:!0}),n(d,"constructor",{value:p,configurable:!0}),p.displayName=c(d,u,"GeneratorFunction"),t.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===p||"GeneratorFunction"===(e.displayName||e.name))},t.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,d):(t.__proto__=d,c(t,u,"GeneratorFunction")),t.prototype=Object.create(g),t},t.awrap=function(t){return{__await:t}},b(E.prototype),c(E.prototype,a,(function(){return this})),t.AsyncIterator=E,t.async=function(e,r,n,o,i){void 0===i&&(i=Promise);var a=new E(l(e,r,n,o),i);return t.isGeneratorFunction(r)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},b(g),c(g,u,"Generator"),c(g,i,(function(){return this})),c(g,"toString",(function(){return"[object Generator]"})),t.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function t(){for(;r.length;){var n=r.pop();if(n in e)return t.value=n,t.done=!1,t}return t.done=!0,t}},t.values=P,S.prototype={constructor:S,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(x),!t)for(var e in this)"t"===e.charAt(0)&&r.call(this,e)&&!isNaN(+e.slice(1))&&(this[e]=void 0)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var e=this;function n(r,n){return a.type="throw",a.arg=t,e.next=r,n&&(e.method="next",e.arg=void 0),!!n}for(var o=this.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],a=i.completion;if("root"===i.tryLoc)return n("end");if(i.tryLoc<=this.prev){var u=r.call(i,"catchLoc"),c=r.call(i,"finallyLoc");if(u&&c){if(this.prev<i.catchLoc)return n(i.catchLoc,!0);if(this.prev<i.finallyLoc)return n(i.finallyLoc)}else if(u){if(this.prev<i.catchLoc)return n(i.catchLoc,!0)}else{if(!c)throw new Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return n(i.finallyLoc)}}}},abrupt:function(t,e){for(var n=this.tryEntries.length-1;n>=0;--n){var o=this.tryEntries[n];if(o.tryLoc<=this.prev&&r.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=t,a.arg=e,i?(this.method="next",this.next=i.finallyLoc,f):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),f},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),x(r),f}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var o=n.arg;x(r)}return o}}throw new Error("illegal catch attempt")},delegateYield:function(t,e,r){return this.delegate={iterator:P(t),resultName:e,nextLoc:r},"next"===this.method&&(this.arg=void 0),f}},t}function Go(t,e,r,n,o,i,a){try{var u=t[i](a),c=u.value}catch(t){return void r(t)}u.done?e(c):Promise.resolve(c).then(n,o)}function Mo(t){return function(){var e=this,r=arguments;return new Promise((function(n,o){var i=t.apply(e,r);function a(t){Go(i,n,o,a,u,"next",t)}function u(t){Go(i,n,o,a,u,"throw",t)}a(void 0)}))}}function Ho(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(void 0,o=function(t,e){if("object"!==Fo(t)||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,"string");if("object"!==Fo(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(n.key),"symbol"===Fo(o)?o:String(o)),n)}var o}function Bo(t,e){return Bo=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},Bo(t,e)}function qo(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var r,n=Yo(t);if(e){var o=Yo(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return function(t,e){if(e&&("object"===Fo(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,r)}}function Yo(t){return Yo=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},Yo(t)}var Wo=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&Bo(t,e)}(u,t);var e,r,n,o,i,a=qo(u);function u(){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,u),a.apply(this,arguments)}return e=u,r=[{key:"getExecutorName",value:function(){return x.SHOP_PAY_CHECKOUT}},{key:"genExecuteActionsBeforeAutofill",value:(i=Mo(Uo().mark((function t(){return Uo().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:case"end":return t.stop()}}),t)}))),function(){return i.apply(this,arguments)})},{key:"genObserveApplyPromoCodeResult",value:(o=Mo(Uo().mark((function t(e){var r;return Uo().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(this.sendPromoExtensionPromoCodeAutofillResultForExecutor({result:O.INFO,event:_.PROMO_CODE_AUTOFILL_ATTEMPT,description:"Promo code autofill attempt"}),null===(r=document.documentElement)){t.next=7;break}if(!this.isPromoCodeSuccess(r,e)){t.next=6;break}return null!=document.body&&window.scrollTo({top:document.body.scrollHeight,behavior:"smooth"}),t.abrupt("return");case 6:this.isErrorElementExist(r,e);case 7:return t.abrupt("return");case 8:case"end":return t.stop()}}),t,this)}))),function(t){return o.apply(this,arguments)})},{key:"genExecute",value:(n=Mo(Uo().mark((function t(){var e,r=this;return Uo().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:e=this.getExecutorName(),it('button[aria-label="Pay now"]').then(Mo(Uo().mark((function t(){return Uo().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,ft(200);case 2:return t.next=4,r.genHandlePromoCodeAutoFillRequest("element-exists-promo-autofill-".concat(e,"-")+c()());case 4:case"end":return t.stop()}}),t)})))).catch((function(t){Z("not shopify-checkout")})),it('button[aria-label="Authorize purchase"]').then(Mo(Uo().mark((function t(){return Uo().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,ft(200);case 2:return t.next=4,r.genHandlePromoCodeAutoFillRequest("element-exists-promo-autofill-".concat(e,"-")+c()());case 4:case"end":return t.stop()}}),t)})))).catch((function(t){Z("not shopify-checkout")}));case 3:case"end":return t.stop()}}),t,this)}))),function(){return n.apply(this,arguments)})},{key:"isPromoCodeSuccess",value:function(t,e){var r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];return!!function(t){return function(t){if(Array.isArray(t))return Do(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(t){if("string"==typeof t)return Do(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?Do(t,e):void 0}}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}(t.getElementsByTagName("button")).some((function(t){var r;return null===(r=t.getAttribute("aria-label"))||void 0===r?void 0:r.includes("".concat(e))}))&&(r&&this.sendPromoExtensionPromoCodeAutofillResultForExecutor({result:O.SUCCESS}),!0)}},{key:"isErrorElementExist",value:function(t,e){var r,n=null!==(r=t.getElementsByClassName("_7ozb2u1p").item(0))&&void 0!==r?r:t.getElementsByClassName("go06b0").item(0);if(null!=n){var o=n.textContent;null!==o&&""!==o||(o="unknown");var i=!1;return h&&(i=this.removeErrorElement(o)),i||this.sendPromoExtensionPromoCodeAutofillResultForExecutor({result:O.FAIL,event:_.HAS_PROMO_CODE_ERROR_ELEMENT,description:o}),!0}return!1}},{key:"removeErrorElement",value:function(t){var e=document.querySelector("button.sdr03s9");return null!==e&&(e.click(),this.sendPromoExtensionPromoCodeAutofillResultForExecutor({result:O.FAIL,event:_.REMOVE_PROMO_CODE_ERROR_ELEMENT,description:t}),!0)}}],r&&Ho(e.prototype,r),Object.defineProperty(e,"prototype",{writable:!1}),u}(Dt);function Ko(t){switch(t){case x.GENERAL:return new Dt;case x.SHOPIFY_STANDARD:return new Xt;case x.SHOPIFY_ENCODED:return new ie;case x.INSTRUCTION_BASED:return new Ro;case x.SHOP_PAY_CHECKOUT:return new Wo;default:throw Error("Not implemented")}}function Vo(t){return Vo="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Vo(t)}function Xo(){/*! regenerator-runtime -- Copyright (c) 2014-present, Facebook, Inc. -- license (MIT): https://github.com/facebook/regenerator/blob/main/LICENSE */Xo=function(){return t};var t={},e=Object.prototype,r=e.hasOwnProperty,n=Object.defineProperty||function(t,e,r){t[e]=r.value},o="function"==typeof Symbol?Symbol:{},i=o.iterator||"@@iterator",a=o.asyncIterator||"@@asyncIterator",u=o.toStringTag||"@@toStringTag";function c(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{c({},"")}catch(t){c=function(t,e,r){return t[e]=r}}function l(t,e,r,o){var i=e&&e.prototype instanceof h?e:h,a=Object.create(i.prototype),u=new S(o||[]);return n(a,"_invoke",{value:w(t,r,u)}),a}function s(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}t.wrap=l;var f={};function h(){}function p(){}function d(){}var v={};c(v,i,(function(){return this}));var y=Object.getPrototypeOf,m=y&&y(y(P([])));m&&m!==e&&r.call(m,i)&&(v=m);var g=d.prototype=h.prototype=Object.create(v);function b(t){["next","throw","return"].forEach((function(e){c(t,e,(function(t){return this._invoke(e,t)}))}))}function E(t,e){function o(n,i,a,u){var c=s(t[n],t,i);if("throw"!==c.type){var l=c.arg,f=l.value;return f&&"object"==Vo(f)&&r.call(f,"__await")?e.resolve(f.__await).then((function(t){o("next",t,a,u)}),(function(t){o("throw",t,a,u)})):e.resolve(f).then((function(t){l.value=t,a(l)}),(function(t){return o("throw",t,a,u)}))}u(c.arg)}var i;n(this,"_invoke",{value:function(t,r){function n(){return new e((function(e,n){o(t,r,e,n)}))}return i=i?i.then(n,n):n()}})}function w(t,e,r){var n="suspendedStart";return function(o,i){if("executing"===n)throw new Error("Generator is already running");if("completed"===n){if("throw"===o)throw i;return{value:void 0,done:!0}}for(r.method=o,r.arg=i;;){var a=r.delegate;if(a){var u=O(a,r);if(u){if(u===f)continue;return u}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if("suspendedStart"===n)throw n="completed",r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);n="executing";var c=s(t,e,r);if("normal"===c.type){if(n=r.done?"completed":"suspendedYield",c.arg===f)continue;return{value:c.arg,done:r.done}}"throw"===c.type&&(n="completed",r.method="throw",r.arg=c.arg)}}}function O(t,e){var r=e.method,n=t.iterator[r];if(void 0===n)return e.delegate=null,"throw"===r&&t.iterator.return&&(e.method="return",e.arg=void 0,O(t,e),"throw"===e.method)||"return"!==r&&(e.method="throw",e.arg=new TypeError("The iterator does not provide a '"+r+"' method")),f;var o=s(n,t.iterator,e.arg);if("throw"===o.type)return e.method="throw",e.arg=o.arg,e.delegate=null,f;var i=o.arg;return i?i.done?(e[t.resultName]=i.value,e.next=t.nextLoc,"return"!==e.method&&(e.method="next",e.arg=void 0),e.delegate=null,f):i:(e.method="throw",e.arg=new TypeError("iterator result is not an object"),e.delegate=null,f)}function _(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function x(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function S(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(_,this),this.reset(!0)}function P(t){if(t){var e=t[i];if(e)return e.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var n=-1,o=function e(){for(;++n<t.length;)if(r.call(t,n))return e.value=t[n],e.done=!1,e;return e.value=void 0,e.done=!0,e};return o.next=o}}return{next:L}}function L(){return{value:void 0,done:!0}}return p.prototype=d,n(g,"constructor",{value:d,configurable:!0}),n(d,"constructor",{value:p,configurable:!0}),p.displayName=c(d,u,"GeneratorFunction"),t.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===p||"GeneratorFunction"===(e.displayName||e.name))},t.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,d):(t.__proto__=d,c(t,u,"GeneratorFunction")),t.prototype=Object.create(g),t},t.awrap=function(t){return{__await:t}},b(E.prototype),c(E.prototype,a,(function(){return this})),t.AsyncIterator=E,t.async=function(e,r,n,o,i){void 0===i&&(i=Promise);var a=new E(l(e,r,n,o),i);return t.isGeneratorFunction(r)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},b(g),c(g,u,"Generator"),c(g,i,(function(){return this})),c(g,"toString",(function(){return"[object Generator]"})),t.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function t(){for(;r.length;){var n=r.pop();if(n in e)return t.value=n,t.done=!1,t}return t.done=!0,t}},t.values=P,S.prototype={constructor:S,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(x),!t)for(var e in this)"t"===e.charAt(0)&&r.call(this,e)&&!isNaN(+e.slice(1))&&(this[e]=void 0)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var e=this;function n(r,n){return a.type="throw",a.arg=t,e.next=r,n&&(e.method="next",e.arg=void 0),!!n}for(var o=this.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],a=i.completion;if("root"===i.tryLoc)return n("end");if(i.tryLoc<=this.prev){var u=r.call(i,"catchLoc"),c=r.call(i,"finallyLoc");if(u&&c){if(this.prev<i.catchLoc)return n(i.catchLoc,!0);if(this.prev<i.finallyLoc)return n(i.finallyLoc)}else if(u){if(this.prev<i.catchLoc)return n(i.catchLoc,!0)}else{if(!c)throw new Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return n(i.finallyLoc)}}}},abrupt:function(t,e){for(var n=this.tryEntries.length-1;n>=0;--n){var o=this.tryEntries[n];if(o.tryLoc<=this.prev&&r.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=t,a.arg=e,i?(this.method="next",this.next=i.finallyLoc,f):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),f},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),x(r),f}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var o=n.arg;x(r)}return o}}throw new Error("illegal catch attempt")},delegateYield:function(t,e,r){return this.delegate={iterator:P(t),resultName:e,nextLoc:r},"next"===this.method&&(this.arg=void 0),f}},t}function Qo(t,e,r,n,o,i,a){try{var u=t[i](a),c=u.value}catch(t){return void r(t)}u.done?e(c):Promise.resolve(c).then(n,o)}function zo(){return null!=document.getElementById(N)}function Jo(){return null!=document.getElementById(P)||null!=document.getElementById(L)}function $o(){return null!=document.getElementById("checkout-main")}function Zo(){return(Zo=function(t){return function(){var e=this,r=arguments;return new Promise((function(n,o){var i=t.apply(e,r);function a(t){Qo(i,n,o,a,u,"next",t)}function u(t){Qo(i,n,o,a,u,"throw",t)}a(void 0)}))}}(Xo().mark((function t(){var e,r,n,a,u,c;return Xo().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return a=null,t.next=3,ct((function(t){return null!=i}));case 3:if(null!=(u=null==i||null===(e=i.autofill)||void 0===e||null===(r=e.shopifyBasedAutoApply)||void 0===r?void 0:r.supported3rdPartyCheckouts)&&Z("Supported 3rd Party Checkouts",u),!0!==(null==i||null===(n=i.autofill)||void 0===n?void 0:n.enable)){t.next=9;break}return a=null!=(null==i||null===(c=i.autofill)||void 0===c?void 0:c.instructionBasedAutoApply)?Ko(x.INSTRUCTION_BASED):zo()?Ko(x.SHOPIFY_STANDARD):Jo()?Ko(x.SHOPIFY_ENCODED):null!=u&&u.includes(o.SHOP_PAY)&&$o()?Ko(x.SHOP_PAY_CHECKOUT):Ko(x.GENERAL),t.next=9,a.genExecute();case 9:case"end":return t.stop()}}),t)})))).apply(this,arguments)}var ti=r(312);(0,ti.registerForPageComplete)((function(){return Zo.apply(this,arguments)})),(0,ti.registerForPageComplete)((function(){return Eo.apply(this,arguments)}))})()})();